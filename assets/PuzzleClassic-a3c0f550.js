import{g,C as k,B as M,_ as z,a as v,b as x}from"./skull-ab8e4955.js";import{C as l}from"./chess-19eddd7f.js";import{_ as N}from"./Chessboard-eadeb67c.js";import{_ as A,h as f,b as r,c as a,g as t,i as m,w as P,v as C,t as n,z as B,F as d,p,A as q}from"./index-4a754309.js";import"./burgerMenu-ba336864.js";const S={mounted(){document.body.classList.add("hide-overflow")},unmounted(){document.body.classList.remove("hide-overflow")},data(){return{difficulty:1e3,fen:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",isWhite:!1,puzzle:{Themes:[]},correctMoves:[],moveNumber:0,square:"",wrongAttempts:0,history:[0],accuracy:{total:0,right:0,percent:100},streak:0,history2:[[-1,-1,-1,-1,-1]],boardAPI:null,offset:0}},async created(){await this.getNewPuzzle()},methods:{async getNewPuzzle(){this.puzzle=await g(this.difficulty,Math.floor(Math.random()*25)),console.log(this.puzzle),this.fen=""+this.puzzle.FEN,this.puzzle.Themes=this.puzzle.Themes.split(" "),this.correctMoves=this.puzzle.Moves.split(" "),this.isWhite=this.fen.split(" ")[1]=="b",await this.makeFirstMove()},async sleep(s){return new Promise(e=>setTimeout(e,s))},async makeFirstMove(){this.fen=""+this.puzzle.FEN,this.$refs.checkMark.deactivate(),await this.sleep(500);const s=new l(this.fen);s.move(this.correctMoves[0]),this.fen=s.fen(),this.moveNumber=1},async handleMove(s){console.log(s);const e=new l(this.fen);if(e.move(s),e.isCheckmate()||this.correctMoves[this.moveNumber]==s.from+s.to)if(this.square=s.to,this.moveNumber==this.correctMoves.length-1){this.accuracy.total++;var c=new Audio("/src/assets/success_sound.wav");c.play(),this.wrongAttempts==0&&(this.difficulty+=20+this.streak+Math.floor(Math.random()*10),this.accuracy.right++,this.streak++,this.difficulty-=this.offset),this.wrongAttempts==1&&(this.difficulty-=5+Math.floor(Math.random()*10),this.streak=0),this.wrongAttempts>1&&(this.difficulty-=15+Math.floor(Math.random()*10),this.streak=0),this.difficulty>3e3&&(this.difficulty=3e3),this.history.push(this.wrongAttempts),this.history2[this.history2.length-1][4]!=-1&&this.history2.push([-1,-1,-1,-1,-1]),this.history2[this.history2.length-1][this.history2[this.history2.length-1].indexOf(-1)]=this.wrongAttempts,this.accuracy.percent=Math.floor(this.accuracy.right/this.accuracy.total*100),this.wrongAttempts=0,await this.getNewPuzzle()}else{var c=new Audio("/src/assets/click_double.wav");c.play(),this.$refs.checkMark.activate();const i=new l(this.fen);i.move(s.from+s.to),i.move(this.correctMoves[this.moveNumber+1]),this.fen=i.fen(),this.moveNumber+=2}else{var c=new Audio("/src/assets/puzzle_fail.wav");c.play(),this.$refs.checkMark.deactivate(),this.wrongAttempts++,await this.makeFirstMove()}},async skip(){this.accuracy.total++,this.difficulty-=15+Math.floor(Math.random()*10),this.streak=0,this.history.push(5),this.history2[this.history2.length-1][4]!=-1&&this.history2.push([-1,-1,-1,-1,-1]),this.history2[this.history2.length-1][this.history2[this.history2.length-1].indexOf(-1)]=5,this.accuracy.percent=Math.floor(this.accuracy.right/this.accuracy.total*100),this.wrongAttempts=0,await this.getNewPuzzle()},makeHint(){console.log(this.correctMoves[this.moveNumber]),this.boardAPI.board.selectSquare(this.correctMoves[this.moveNumber][0]+this.correctMoves[this.moveNumber][1]),this.offset=10},async makeSolution(){this.$refs.checkMark.deactivate();const s=new l(this.fen);if(s.move(this.correctMoves[this.moveNumber]),this.moveNumber++,this.fen=s.fen(),this.wrongAttempts=2,s.isCheckmate()||this.moveNumber==this.correctMoves.length){this.accuracy.total++;var e=new Audio("/src/assets/success_sound.wav");e.play(),await this.sleep(1e3),this.wrongAttempts==0&&(this.difficulty+=20+this.streak+Math.floor(Math.random()*10),this.accuracy.right++,this.streak++),this.wrongAttempts==1&&(this.difficulty-=5+Math.floor(Math.random()*10),this.streak=0),this.wrongAttempts>1&&(this.difficulty-=15+Math.floor(Math.random()*10),this.streak=0),this.difficulty>3e3&&(this.difficulty=3e3),this.history.push(this.wrongAttempts),this.history2[this.history2.length-1][4]!=-1&&this.history2.push([-1,-1,-1,-1,-1]),this.history2[this.history2.length-1][this.history2[this.history2.length-1].indexOf(-1)]=this.wrongAttempts,this.accuracy.percent=Math.floor(this.accuracy.right/this.accuracy.total*100),this.wrongAttempts=0,await this.getNewPuzzle()}else{var e=new Audio("/src/assets/click_double.wav");e.play(),await this.sleep(1e3);const u=new l(this.fen);u.move(this.correctMoves[this.moveNumber]),this.moveNumber++,this.fen=u.fen()}}},watch:{difficulty(s){this.difficulty=Number(s)}},components:{Chessboard:N,Checkmark:k,BurgerMenuHorizontal:M}},F={class:"h-screen flex justify-center items-center"},H={class:"basis-1/4 flex flex-col h-full p-4 items-center"},T={class:"text-xl mt-2"},j={class:"flex w-full justify-between p-4"},V={class:"relative w-1/2 scale-110"},W={class:"ml-36 relative w-1/2 scale-[3] flex items-center justify-center"},E=t("img",{src:z,class:"absolute z-10"},null,-1),I={class:"absolute z-20 text-black font-bold mt-5 text-xs"},L={class:"border-accent border-4 rounded-xl m-4 w-full h-1/2"},O={class:"flex-grow w-full h-full"},R={class:"flex-content"},D={class:"scrollable-content-wrapper"},K={class:"flex flex-row justify-around my-8"},Q={key:0,class:"scale-150",src:v},U={key:1,class:"scale-150",src:x},G={key:2,class:"scale-150 invisible",src:v},J={class:"w-full h-[8%] overflow-hidden"},X={class:"h-full w-full flex flex-wrap"},Y={class:"badge-secondary badge p-1 mx-1"},Z={class:"w-1/2 relative flex h-full"},$={class:"basis-1/4 h-full w-full py-4 flex justify-around"},tt=t("span",{class:"material-symbols-outlined"}," lightbulb ",-1),st=[tt],et=t("span",{class:"material-symbols-outlined"}," saved_search ",-1),it=[et],ot=t("span",{class:"material-symbols-outlined"}," skip_next ",-1),rt=[ot];function at(s,e,c,u,i,h){const _=f("BurgerMenuHorizontal"),w=f("Chessboard"),b=f("Checkmark");return r(),a("div",F,[t("div",H,[m(_,{class:"w-full"}),P(t("input",{type:"range",min:"400",max:"3000","onUpdate:modelValue":e[0]||(e[0]=o=>i.difficulty=o),class:"range range-accent mt-4"},null,512),[[C,i.difficulty]]),t("p",T,n(i.difficulty),1),t("div",j,[t("div",V,[t("div",{class:"radial-progress bg-primary text-primary-content border-4 border-primary",style:B("--value:"+i.accuracy.percent)},n(i.accuracy.percent),5)]),t("div",W,[E,t("div",I,n(i.streak),1)])]),t("div",L,[t("div",O,[t("div",R,[t("div",D,[(r(!0),a(d,null,p(i.history2,o=>(r(),a("div",K,[(r(!0),a(d,null,p(o,y=>(r(),a("div",null,[y==0?(r(),a("img",Q)):q("",!0),y>0?(r(),a("img",U)):(r(),a("img",G))]))),256))]))),256))])])])]),t("div",J,[t("div",X,[(r(!0),a(d,null,p(i.puzzle.Themes,o=>(r(),a("div",null,[t("div",Y,n(o),1)]))),256))])])]),t("div",Z,[m(w,{onBoardCreated:e[1]||(e[1]=o=>i.boardAPI=o),onMove:h.handleMove,fen:i.fen,orientation:i.isWhite?"white":"black",ref:"chessboard"},null,8,["onMove","fen","orientation"]),m(b,{square:i.square,ref:"checkMark",white:i.isWhite},null,8,["square","white"])]),t("div",$,[t("button",{onClick:e[2]||(e[2]=(...o)=>h.makeHint&&h.makeHint(...o)),class:"btn w-1/4 btn-primary mr-2 tooltip tooltip-bottom","data-tip":"Hint"},st),t("button",{class:"btn w-1/4 btn-primary btn-square mr-2 tooltip tooltip-bottom","data-tip":"Solution",onClick:e[3]||(e[3]=(...o)=>h.makeSolution&&h.makeSolution(...o))},it),t("button",{class:"btn w-1/4 btn-primary btn-square mr-2 tooltip-bottom tooltip","data-tip":"Skip",onClick:e[4]||(e[4]=(...o)=>h.skip&&h.skip(...o))},rt)])])}const ft=A(S,[["render",at]]);export{ft as default};
