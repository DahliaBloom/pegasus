import{_,b as a,c as n,f as o,t as l,s as r,g as b,F as m,x as M,e as x,w as d,v as g}from"./index-43184f9f.js";const c={props:{evaluation:{type:Number,required:!0}},data(){return{height:50,heightString:"50%"}},methods:{update(){if(console.log("update"),this.evaluation==="0.0"||this.evaluation==="0"){this.height=50,this.heightString=this.height+"%";return}let e=Number(this.evaluation);console.log("TMP:"+e),e>0&&(Math.abs(e)<1?(this.height=50+e*10,console.log("-1< x <1")):Math.abs(e)<3?(this.height=50+e*8,console.log("-3< x <3")):Math.abs(e)<6?(this.height=70+e*2,console.log("-6< x <6")):Math.abs(e)<11?(this.height=80+e,console.log("-9< x <9")):e>11&&(this.height=50+Math.log(Math.abs(e))*30)),e<0&&(Math.abs(e)<1?(this.height=50+e*10,console.log("-1< x <1")):Math.abs(e)<3?(this.height=50+e*8,console.log("-3< x <3")):Math.abs(e)<6?(this.height=30+e*2,console.log("-6< x <6")):Math.abs(e)<11?(this.height=20+e,console.log("-9< x <9")):e<-11&&(this.height=50-Math.log(Math.abs(e))*30)),this.height>96&&(this.height=96),this.height<4&&(this.height=4),this.heightString=this.height+"%"}},beforeMount(){this.update()},updated(){this.update()}},p=()=>{M(e=>({"11c38080":e.heightString}))},f=c.setup;c.setup=f?(e,t)=>(p(),f(e,t)):p;const k={class:"w-12 h-full relative flex-none border-accent border-2 m-4"},P={class:"bg-black text-white text-center font-bold h-full"},S={key:0},y={class:"bg-white w-full text-center text-black absolute bottom-0 left-0 evalWhite"},$={key:0,class:"absolute bottom-0 left-1/4"};function E(e,t,s,i,T,q){return a(),n(m,null,[o("div",k,[o("div",P,[this.evaluation<0?(a(),n("div",S,l(this.evaluation),1)):r("",!0),o("div",y,[this.evaluation>=0?(a(),n("span",$,l(this.evaluation),1)):r("",!0)])])]),b(" "+l(this.heightString),1)],64)}const v=_(c,[["render",E],["__scopeId","data-v-12d40243"]]);let h,u=0;console.log("Starting stockfish");Stockfish().then(e=>{e.postMessage("setoption name use nnue value true"),e.addMessageListener(N),h=e,console.log("Stockfish started")});function N(e){if(e.startsWith("Final")){const s=/Final evaluation\s+([+-]?\d+\.\d+)/.exec(e);u=parseFloat(s[1]),console.log("Pegasus Final Score: "+u)}}async function B(e,t){if(h===void 0)return 0;h.postMessage(`position fen ${e}`),h.postMessage("eval"),setTimeout(()=>{t(u)},100)}const V={class:"flex",style:{height:"90vb"}},w={key:0},F=o("p",null,"r1b1k1nr/pppp1ppp/2n2q2/2b1p3/2B1P1Q1/2N5/PPPP1PPP/R1B1K1NR w KQkq - 6 5",-1),C={data(){return{fen:"",score:0,stockfish:null,custom:0}},methods:{evaluatePosition(){B(this.fen,e=>{console.log("Received score:",e),this.score=e})}},components:{EvalBar:v}},j=Object.assign(C,{__name:"Analyze",setup(e){return(t,s)=>(a(),n("div",V,[x(v,{ref:"evalBar",evaluation:t.score},null,8,["evaluation"]),o("div",null,[d(o("input",{"onUpdate:modelValue":s[0]||(s[0]=i=>t.fen=i),type:"text",placeholder:"Enter FEN string"},null,512),[[g,t.fen]]),o("button",{onClick:s[1]||(s[1]=(...i)=>t.evaluatePosition&&t.evaluatePosition(...i))},"Evaluate"),d(o("input",{"onUpdate:modelValue":s[2]||(s[2]=i=>t.custom=i),type:"text",placeholder:"Enter Custom Evaluation"},null,512),[[g,t.custom]]),o("button",{onClick:s[3]||(s[3]=i=>this.score=this.custom)},"Submit"),t.score!==0?(a(),n("div",w,"Evaluation score: "+l(t.score),1)):r("",!0),F])]))}});export{j as default};
