import{g as z,C as b,B as M,_ as x,a as p,b as N}from"./skull-10c02c5d.js";import{C as n}from"./chess-19eddd7f.js";import{_ as P}from"./Chessboard-383cdb77.js";import{_ as C,h as u,b as e,c as t,g as o,i as f,t as d,F as m,p as _,A as c}from"./index-2ee41cca.js";import"./burgerMenu-ba336864.js";const l="/pegasus/assets/heart-e7db764f.svg",B={mounted(){document.body.classList.add("hide-overflow")},unmounted(){document.body.classList.remove("hide-overflow")},data(){return{difficulty:1e3,fen:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",isWhite:!1,puzzle:{Themes:[]},correctMoves:[],moveNumber:0,square:"",wrongAttempts:0,history:[0],accuracy:{total:0,right:0,percent:100},streak:0,history2:[[-1,-1,-1,-1,-1]],boardAPI:null,mistakes:0}},async created(){await this.getNewPuzzle()},methods:{async getNewPuzzle(){this.puzzle=await z(this.difficulty,Math.floor(Math.random()*25)),console.log(this.puzzle),this.fen=""+this.puzzle.FEN,this.puzzle.Themes=this.puzzle.Themes.split(" "),this.correctMoves=this.puzzle.Moves.split(" "),this.isWhite=this.fen.split(" ")[1]=="b",await this.makeFirstMove()},async sleep(i){return new Promise(r=>setTimeout(r,i))},async makeFirstMove(){this.fen=""+this.puzzle.FEN,this.$refs.checkMark.deactivate(),await this.sleep(500);const i=new n(this.fen);i.move(this.correctMoves[0]),this.fen=i.fen(),this.moveNumber=1},async handleMove(i){console.log(i);const r=new n(this.fen);if(r.move(i),r.isCheckmate()||this.correctMoves[this.moveNumber]==i.from+i.to)if(this.square=i.to,this.moveNumber==this.correctMoves.length-1){this.accuracy.total++;var h=new Audio("/src/assets/success_sound.wav");h.play(),this.difficulty+=20+Math.floor(Math.random()*10),this.streak++,this.difficulty>3e3&&(this.difficulty=3e3),this.history.push(0),this.history2[this.history2.length-1][4]!=-1&&this.history2.push([-1,-1,-1,-1,-1]),this.history2[this.history2.length-1][this.history2[this.history2.length-1].indexOf(-1)]=0,await this.getNewPuzzle()}else{var h=new Audio("/src/assets/click_double.wav");h.play(),this.$refs.checkMark.activate();const s=new n(this.fen);s.move(i.from+i.to),s.move(this.correctMoves[this.moveNumber+1]),this.fen=s.fen(),this.moveNumber+=2}else{var h=new Audio("/src/assets/puzzle_fail.wav");h.play(),this.$refs.checkMark.deactivate(),this.mistakes++,this.mistakes==3&&my_modal_1.showModal(),await this.skip()}},async skip(){this.accuracy.total++,this.difficulty-=15+Math.floor(Math.random()*10),this.streak=0,this.history.push(5),this.history2[this.history2.length-1][4]!=-1&&this.history2.push([-1,-1,-1,-1,-1]),this.history2[this.history2.length-1][this.history2[this.history2.length-1].indexOf(-1)]=5,this.accuracy.percent=Math.floor(this.accuracy.right/this.accuracy.total*100),this.wrongAttempts=0,await this.getNewPuzzle()}},watch:{difficulty(i){this.difficulty=Number(i)}},components:{Chessboard:P,Checkmark:b,BurgerMenuHorizontal:M}},A={class:"h-screen flex justify-center items-center"},q={class:"basis-1/4 flex flex-col h-full p-4 items-center"},F={class:"flex w-full justify-between p-4"},j={class:"text-xl mt-2"},T={class:"ml-36 relative w-1/2 scale-[3] flex items-center justify-center"},R=o("img",{src:x,class:"absolute z-10"},null,-1),W={class:"absolute z-20 text-black font-bold mt-5 text-xs"},E={class:"border-accent border-4 rounded-xl m-4 mt-12 w-full h-1/2"},H={class:"flex-grow w-full h-full"},L={class:"flex-content"},V={class:"scrollable-content-wrapper"},I={class:"flex flex-row justify-around my-8"},K={key:0,class:"scale-150",src:p},O={key:1,class:"scale-150",src:N},Q={key:2,class:"scale-150 invisible",src:p},D={class:"w-full h-[8%] overflow-hidden"},S={class:"h-full w-full flex flex-wrap"},G={class:"badge-secondary badge p-1 mx-1"},J={class:"w-1/2 relative flex h-full"},U={class:"basis-1/4 h-full w-full py-4 flex justify-around"},X={key:0,class:"w-20 h-20 grayscale",src:l},Y={key:1,class:"w-20 h-20 grayscale",src:l},Z={key:2,class:"w-20 h-20 grayscale",src:l},$={key:3,class:"w-20 h-20",src:l},ss={key:4,class:"w-20 h-20",src:l},es={key:5,class:"w-20 h-20",src:l};function ts(i,r,h,is,s,v){const w=u("BurgerMenuHorizontal"),k=u("Chessboard"),g=u("Checkmark");return e(),t("div",A,[o("div",q,[f(w,{class:"w-full"}),o("div",F,[o("p",j,d(s.difficulty),1),o("div",T,[R,o("div",W,d(s.streak),1)])]),o("div",E,[o("div",H,[o("div",L,[o("div",V,[(e(!0),t(m,null,_(s.history2,a=>(e(),t("div",I,[(e(!0),t(m,null,_(a,y=>(e(),t("div",null,[y==0?(e(),t("img",K)):c("",!0),y>0?(e(),t("img",O)):(e(),t("img",Q))]))),256))]))),256))])])])]),o("div",D,[o("div",S,[(e(!0),t(m,null,_(s.puzzle.Themes,a=>(e(),t("div",null,[o("div",G,d(a),1)]))),256))])])]),o("div",J,[f(k,{onBoardCreated:r[0]||(r[0]=a=>s.boardAPI=a),onMove:v.handleMove,fen:s.fen,orientation:s.isWhite?"white":"black",ref:"chessboard"},null,8,["onMove","fen","orientation"]),f(g,{square:s.square,ref:"checkMark",white:s.isWhite},null,8,["square","white"])]),o("div",U,[s.mistakes>0?(e(),t("img",X)):c("",!0),s.mistakes>1?(e(),t("img",Y)):c("",!0),s.mistakes>2?(e(),t("img",Z)):c("",!0),s.mistakes<1?(e(),t("img",$)):c("",!0),s.mistakes<2?(e(),t("img",ss)):c("",!0),s.mistakes<3?(e(),t("img",es)):c("",!0)])])}const as=C(B,[["render",ts]]);export{as as default};
