var Lr=Object.defineProperty;var Nr=(t,e,r)=>e in t?Lr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var _e=(t,e,r)=>(Nr(t,typeof e!="symbol"?e+"":e,r),r);import{g as Mr}from"./_commonjsHelpers-725317a4.js";import{_ as Dr,b as jr,c as Hr,g as sr}from"./index-44112637.js";const ws="/pegasus/assets/standard-avatar-022619a5.png";function Qr(t){return t==="string"?"":t==="object"?{}:t==="function"?()=>null:t==="array"?[]:null}function Ur(t,e){const r=[];for(let n=0;n<e.length;n+=1)if(e[n]!==void 0){for(;r.length<t.length&&(typeof e[n]!==t[r.length]||e[n]instanceof Array)&&(!(e[n]instanceof Array)||e[n]instanceof Array&&t[r.length]!=="array");)r.push(Qr(t[r.length]));r.length<t.length&&r.push(e[n])}return r}var Ee={sortParameters:Ur};const{sortParameters:Kr}=Ee;function Br(){this._requests=[],this._running=!1}function Fr(t,e,r,n,i,s){if(!t||typeof t!="function")throw Error("dispatch requires request function");if(!e||typeof e!="function")throw Error("dispatch requires callback function");const[a,l,d,_]=Kr(["array","object","array","number"],[r,n,i,s]),C={method:t,callback:e,parameters:a,options:l,priority:_||1,callbackParameters:d||[]};this.enqueue(C)}function Gr(t){let e=!1;for(let r=0;r<this._requests.length;r+=1)if(this._requests[r].priority>t.priority){this._requests.splice(r,0,t),e=!0;break}e||this._requests.push(t),this._running||this.startRequests()}function Wr(){return this._requests.length===0?null:this._requests.shift()}function zr(){this._requests=[]}async function Xr(){for(;this._requests.length>0;){this._running||(this._running=!0);const t=this.dequeue(),{method:e,callback:r}=t;let n=null;const i=await e(...t.parameters,t.options).catch(s=>n=s);r(i,n,...t.callbackParameters)}this._running=!1}var Jr={queueSetup:Br,dispatch:Fr,enqueue:Gr,dequeue:Wr,clearQueue:zr,startRequests:Xr},Pe={},_r={};const W=function(t){if(!t)throw new Error("No builder supplied to constructor");this.host=t.host,this.port=t.port,this.scheme=t.scheme,this.queryParameters=t.queryParameters,this.bodyParameters=t.bodyParameters,this.headers=t.headers,this.path=t.path};W.prototype._getter=function(t){return function(){return this[t]}};W.prototype.getHost=W.prototype._getter("host");W.prototype.getPort=W.prototype._getter("port");W.prototype.getScheme=W.prototype._getter("scheme");W.prototype.getPath=W.prototype._getter("path");W.prototype.getQueryParameters=W.prototype._getter("queryParameters");W.prototype.getBodyParameters=W.prototype._getter("bodyParameters");W.prototype.getHeaders=W.prototype._getter("headers");W.prototype.getURI=function(){if(!this.scheme||!this.host||!this.port)throw new Error("Missing components necessary to construct URI");let t=`${this.scheme}://${this.host}`;return(this.scheme==="http"&&this.port!==80||this.scheme==="https"&&this.port!==443)&&(t+=`:${this.port}`),this.path&&(t+=this.path),t};W.prototype.getURL=function(){const t=this.getURI();return this.getQueryParameters()?t+this.getQueryParameterString(this.getQueryParameters()):t};W.prototype.getQueryParameterString=function(){const t=this.getQueryParameters();return t?`?${Object.keys(t).filter(e=>t[e]!==void 0).map(e=>`${e}=${t[e]}`).join("&")}`:""};W.prototype.execute=function(t,e){if(e)return t(this,e),null;const r=this;return new Promise((n,i)=>{t(r,(s,a)=>{s?i(s):n(a)})})};const J=function(){};J.prototype._setter=function(t){return function(e){return this[t]=e,this}};J.prototype.withHost=J.prototype._setter("host");J.prototype.withPort=J.prototype._setter("port");J.prototype.withScheme=J.prototype._setter("scheme");J.prototype.withPath=J.prototype._setter("path");J.prototype._assigner=function(t){return function(){for(let e=0;e<arguments.length;e+=1)this[t]=this._assign(this[t],arguments[e]);return this}};J.prototype.withQueryParameters=J.prototype._assigner("queryParameters");J.prototype.withBodyParameters=J.prototype._assigner("bodyParameters");J.prototype.withHeaders=J.prototype._assigner("headers");J.prototype._assign=function(t,e){return e&&Array.isArray(e)?e:e&&Object.keys(e).length>0?Object.assign(t||{},e):t};J.prototype.build=function(){return new W(this)};_r.builder=function(){return new J};const Yr=_r,Zr="api.chess.com",Vr=443,en="https";Pe.builder=function(){return Yr.builder().withHost(Zr).withPort(Vr).withScheme(en)};var kt={exports:{}},gr={exports:{}};(function(t){t.exports=e;function e(n){if(n)return r(n)}function r(n){for(var i in e.prototype)n[i]=e.prototype[i];return n}e.prototype.on=e.prototype.addEventListener=function(n,i){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(i),this},e.prototype.once=function(n,i){function s(){this.off(n,s),i.apply(this,arguments)}return s.fn=i,this.on(n,s),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(n,i){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var s=this._callbacks["$"+n];if(!s)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var a,l=0;l<s.length;l++)if(a=s[l],a===i||a.fn===i){s.splice(l,1);break}return s.length===0&&delete this._callbacks["$"+n],this},e.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var i=new Array(arguments.length-1),s=this._callbacks["$"+n],a=1;a<arguments.length;a++)i[a-1]=arguments[a];if(s){s=s.slice(0);for(var a=0,l=s.length;a<l;++a)s[a].apply(this,i)}return this},e.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]},e.prototype.hasListeners=function(n){return!!this.listeners(n).length}})(gr);var tn=gr.exports,rn=Ye;Ye.default=Ye;Ye.stable=br;Ye.stableStringify=br;var ct="[...]",mr="[Circular]",He=[],Me=[];function yr(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function Ye(t,e,r,n){typeof n>"u"&&(n=yr()),It(t,"",0,[],void 0,0,n);var i;try{Me.length===0?i=JSON.stringify(t,e,r):i=JSON.stringify(t,vr(e),r)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;He.length!==0;){var s=He.pop();s.length===4?Object.defineProperty(s[0],s[1],s[3]):s[0][s[1]]=s[2]}}return i}function Ke(t,e,r,n){var i=Object.getOwnPropertyDescriptor(n,r);i.get!==void 0?i.configurable?(Object.defineProperty(n,r,{value:t}),He.push([n,r,e,i])):Me.push([e,r,t]):(n[r]=t,He.push([n,r,e]))}function It(t,e,r,n,i,s,a){s+=1;var l;if(typeof t=="object"&&t!==null){for(l=0;l<n.length;l++)if(n[l]===t){Ke(mr,t,e,i);return}if(typeof a.depthLimit<"u"&&s>a.depthLimit){Ke(ct,t,e,i);return}if(typeof a.edgesLimit<"u"&&r+1>a.edgesLimit){Ke(ct,t,e,i);return}if(n.push(t),Array.isArray(t))for(l=0;l<t.length;l++)It(t[l],l,l,n,t,s,a);else{var d=Object.keys(t);for(l=0;l<d.length;l++){var _=d[l];It(t[_],_,l,n,t,s,a)}}n.pop()}}function nn(t,e){return t<e?-1:t>e?1:0}function br(t,e,r,n){typeof n>"u"&&(n=yr());var i=qt(t,"",0,[],void 0,0,n)||t,s;try{Me.length===0?s=JSON.stringify(i,e,r):s=JSON.stringify(i,vr(e),r)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;He.length!==0;){var a=He.pop();a.length===4?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return s}function qt(t,e,r,n,i,s,a){s+=1;var l;if(typeof t=="object"&&t!==null){for(l=0;l<n.length;l++)if(n[l]===t){Ke(mr,t,e,i);return}try{if(typeof t.toJSON=="function")return}catch{return}if(typeof a.depthLimit<"u"&&s>a.depthLimit){Ke(ct,t,e,i);return}if(typeof a.edgesLimit<"u"&&r+1>a.edgesLimit){Ke(ct,t,e,i);return}if(n.push(t),Array.isArray(t))for(l=0;l<t.length;l++)qt(t[l],l,l,n,t,s,a);else{var d={},_=Object.keys(t).sort(nn);for(l=0;l<_.length;l++){var C=_[l];qt(t[C],C,l,n,t,s,a),d[C]=t[C]}if(typeof i<"u")He.push([i,e,t]),i[e]=d;else return d}n.pop()}}function vr(t){return t=typeof t<"u"?t:function(e,r){return r},function(e,r){if(Me.length>0)for(var n=0;n<Me.length;n++){var i=Me[n];if(i[1]===e&&i[0]===r){r=i[2],Me.splice(n,1);break}}return t.call(this,e,r)}}function at(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?at=function(r){return typeof r}:at=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},at(t)}function sn(t){return t!==null&&at(t)==="object"}var wr=sn;function ut(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ut=function(r){return typeof r}:ut=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ut(t)}var ft=wr,on=$;function $(t){if(t)return an(t)}function an(t){for(var e in $.prototype)Object.prototype.hasOwnProperty.call($.prototype,e)&&(t[e]=$.prototype[e]);return t}$.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this};$.prototype.parse=function(t){return this._parser=t,this};$.prototype.responseType=function(t){return this._responseType=t,this};$.prototype.serialize=function(t){return this._serializer=t,this};$.prototype.timeout=function(t){if(!t||ut(t)!=="object")return this._timeout=t,this._responseTimeout=0,this._uploadTimeout=0,this;for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))switch(e){case"deadline":this._timeout=t.deadline;break;case"response":this._responseTimeout=t.response;break;case"upload":this._uploadTimeout=t.upload;break;default:console.warn("Unknown timeout option",e)}return this};$.prototype.retry=function(t,e){return(arguments.length===0||t===!0)&&(t=1),t<=0&&(t=0),this._maxRetries=t,this._retries=0,this._retryCallback=e,this};var un=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];$.prototype._shouldRetry=function(t,e){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var r=this._retryCallback(t,e);if(r===!0)return!0;if(r===!1)return!1}catch(n){console.error(n)}return!!(e&&e.status&&e.status>=500&&e.status!==501||t&&(t.code&&un.includes(t.code)||t.timeout&&t.code==="ECONNABORTED"||t.crossDomain))};$.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()};$.prototype.then=function(t,e){var r=this;if(!this._fullfilledPromise){var n=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise(function(i,s){n.on("abort",function(){if(!(r._maxRetries&&r._maxRetries>r._retries)){if(r.timedout&&r.timedoutError){s(r.timedoutError);return}var a=new Error("Aborted");a.code="ABORTED",a.status=r.status,a.method=r.method,a.url=r.url,s(a)}}),n.end(function(a,l){a?s(a):i(l)})})}return this._fullfilledPromise.then(t,e)};$.prototype.catch=function(t){return this.then(void 0,t)};$.prototype.use=function(t){return t(this),this};$.prototype.ok=function(t){if(typeof t!="function")throw new Error("Callback required");return this._okCallback=t,this};$.prototype._isResponseOK=function(t){return t?this._okCallback?this._okCallback(t):t.status>=200&&t.status<300:!1};$.prototype.get=function(t){return this._header[t.toLowerCase()]};$.prototype.getHeader=$.prototype.get;$.prototype.set=function(t,e){if(ft(t)){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&this.set(r,t[r]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this};$.prototype.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this};$.prototype.field=function(t,e){if(t==null)throw new Error(".field(name, val) name can not be empty");if(this._data)throw new Error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()");if(ft(t)){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&this.field(r,t[r]);return this}if(Array.isArray(e)){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&this.field(t,e[n]);return this}if(e==null)throw new Error(".field(name, val) val can not be empty");return typeof e=="boolean"&&(e=String(e)),this._getFormData().append(t,e),this};$.prototype.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)};$.prototype._auth=function(t,e,r,n){switch(r.type){case"basic":this.set("Authorization","Basic ".concat(n("".concat(t,":").concat(e))));break;case"auto":this.username=t,this.password=e;break;case"bearer":this.set("Authorization","Bearer ".concat(t));break}return this};$.prototype.withCredentials=function(t){return t===void 0&&(t=!0),this._withCredentials=t,this};$.prototype.redirects=function(t){return this._maxRedirects=t,this};$.prototype.maxResponseSize=function(t){if(typeof t!="number")throw new TypeError("Invalid argument");return this._maxResponseSize=t,this};$.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}};$.prototype.send=function(t){var e=ft(t),r=this._header["content-type"];if(this._formData)throw new Error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()");if(e&&!this._data)Array.isArray(t)?this._data=[]:this._isHost(t)||(this._data={});else if(t&&this._data&&this._isHost(this._data))throw new Error("Can't merge these send calls");if(e&&ft(this._data))for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(this._data[n]=t[n]);else typeof t=="string"?(r||this.type("form"),r=this._header["content-type"],r==="application/x-www-form-urlencoded"?this._data=this._data?"".concat(this._data,"&").concat(t):t:this._data=(this._data||"")+t):this._data=t;return!e||this._isHost(t)?this:(r||this.type("json"),this)};$.prototype.sortQuery=function(t){return this._sort=typeof t>"u"?!0:t,this};$.prototype._finalizeQueryString=function(){var t=this._query.join("&");if(t&&(this.url+=(this.url.includes("?")?"&":"?")+t),this._query.length=0,this._sort){var e=this.url.indexOf("?");if(e>=0){var r=this.url.slice(e+1).split("&");typeof this._sort=="function"?r.sort(this._sort):r.sort(),this.url=this.url.slice(0,e)+"?"+r.join("&")}}};$.prototype._appendQueryString=function(){console.warn("Unsupported")};$.prototype._timeoutError=function(t,e,r){if(!this._aborted){var n=new Error("".concat(t+e,"ms exceeded"));n.timeout=e,n.code="ECONNABORTED",n.errno=r,this.timedout=!0,this.timedoutError=n,this.abort(),this.callback(n)}};$.prototype._setTimeouts=function(){var t=this;this._timeout&&!this._timer&&(this._timer=setTimeout(function(){t._timeoutError("Timeout of ",t._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(function(){t._timeoutError("Response timeout of ",t._responseTimeout,"ETIMEDOUT")},this._responseTimeout))};var Ve={};Ve.type=function(t){return t.split(/ *; */).shift()};Ve.params=function(t){return t.split(/ *; */).reduce(function(e,r){var n=r.split(/ *= */),i=n.shift(),s=n.shift();return i&&s&&(e[i]=s),e},{})};Ve.parseLinks=function(t){return t.split(/ *, */).reduce(function(e,r){var n=r.split(/ *; */),i=n[0].slice(1,-1),s=n[1].split(/ *= */)[1].slice(1,-1);return e[s]=i,e},{})};Ve.cleanHeader=function(t,e){return delete t["content-type"],delete t["content-length"],delete t["transfer-encoding"],delete t.host,e&&(delete t.authorization,delete t.cookie),t};var Tt=Ve,ln=De;function De(t){if(t)return cn(t)}function cn(t){for(var e in De.prototype)Object.prototype.hasOwnProperty.call(De.prototype,e)&&(t[e]=De.prototype[e]);return t}De.prototype.get=function(t){return this.header[t.toLowerCase()]};De.prototype._setHeaderProperties=function(t){var e=t["content-type"]||"";this.type=Tt.type(e);var r=Tt.params(e);for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(this[n]=r[n]);this.links={};try{t.link&&(this.links=Tt.parseLinks(t.link))}catch{}};De.prototype._setStatusProperties=function(t){var e=t/100|0;this.statusCode=t,this.status=this.statusCode,this.statusType=e,this.info=e===1,this.ok=e===2,this.redirect=e===3,this.clientError=e===4,this.serverError=e===5,this.error=e===4||e===5?this.toError():!1,this.created=t===201,this.accepted=t===202,this.noContent=t===204,this.badRequest=t===400,this.unauthorized=t===401,this.notAcceptable=t===406,this.forbidden=t===403,this.notFound=t===404,this.unprocessableEntity=t===422};function fn(t){return _n(t)||dn(t)||pn(t)||hn()}function hn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pn(t,e){if(t){if(typeof t=="string")return xt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xt(t,e)}}function dn(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function _n(t){if(Array.isArray(t))return xt(t)}function xt(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Mt(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert","disableTLSCerts"].forEach(function(t){Mt.prototype[t]=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return this._defaults.push({fn:t,args:r}),this}});Mt.prototype._setDefaults=function(t){this._defaults.forEach(function(e){t[e.fn].apply(t,fn(e.args))})};var gn=Mt;(function(t,e){function r(c){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?r=function(g){return typeof g}:r=function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},r(c)}var n;typeof window<"u"?n=window:typeof self>"u"?(console.warn("Using browser-only version of superagent in non-browser environment"),n=void 0):n=self;var i=tn,s=rn,a=on,l=wr,d=ln,_=gn;function C(){}t.exports=function(c,p){return typeof p=="function"?new e.Request("GET",c).end(p):arguments.length===1?new e.Request("GET",c):new e.Request(c,p)},e=t.exports;var E=e;e.Request=P,E.getXHR=function(){if(n.XMLHttpRequest&&(!n.location||n.location.protocol!=="file:"||!n.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch{}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch{}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch{}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch{}throw new Error("Browser-only version of superagent could not find XHR")};var b="".trim?function(c){return c.trim()}:function(c){return c.replace(/(^\s*|\s*$)/g,"")};function M(c){if(!l(c))return c;var p=[];for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&T(p,g,c[g]);return p.join("&")}function T(c,p,g){if(g!==void 0){if(g===null){c.push(encodeURI(p));return}if(Array.isArray(g))g.forEach(function(I){T(c,p,I)});else if(l(g))for(var v in g)Object.prototype.hasOwnProperty.call(g,v)&&T(c,"".concat(p,"[").concat(v,"]"),g[v]);else c.push(encodeURI(p)+"="+encodeURIComponent(g))}}E.serializeObject=M;function k(c){for(var p={},g=c.split("&"),v,I,S=0,K=g.length;S<K;++S)v=g[S],I=v.indexOf("="),I===-1?p[decodeURIComponent(v)]="":p[decodeURIComponent(v.slice(0,I))]=decodeURIComponent(v.slice(I+1));return p}E.parseString=k,E.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},E.serialize={"application/x-www-form-urlencoded":M,"application/json":s},E.parse={"application/x-www-form-urlencoded":k,"application/json":JSON.parse};function D(c){for(var p=c.split(/\r?\n/),g={},v,I,S,K,w=0,H=p.length;w<H;++w)I=p[w],v=I.indexOf(":"),v!==-1&&(S=I.slice(0,v).toLowerCase(),K=b(I.slice(v+1)),g[S]=K);return g}function B(c){return/[/+]json($|[^-\w])/.test(c)}function ae(c){this.req=c,this.xhr=this.req.xhr,this.text=this.req.method!=="HEAD"&&(this.xhr.responseType===""||this.xhr.responseType==="text")||typeof this.xhr.responseType>"u"?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var p=this.xhr.status;p===1223&&(p=204),this._setStatusProperties(p),this.headers=D(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),this.text===null&&c._responseType?this.body=this.xhr.response:this.body=this.req.method==="HEAD"?null:this._parseBody(this.text?this.text:this.xhr.response)}d(ae.prototype),ae.prototype._parseBody=function(c){var p=E.parse[this.type];return this.req._parser?this.req._parser(this,c):(!p&&B(this.type)&&(p=E.parse["application/json"]),p&&c&&(c.length>0||c instanceof Object)?p(c):null)},ae.prototype.toError=function(){var c=this.req,p=c.method,g=c.url,v="cannot ".concat(p," ").concat(g," (").concat(this.status,")"),I=new Error(v);return I.status=this.status,I.method=p,I.url=g,I},E.Response=ae;function P(c,p){var g=this;this._query=this._query||[],this.method=c,this.url=p,this.header={},this._header={},this.on("end",function(){var v=null,I=null;try{I=new ae(g)}catch(K){return v=new Error("Parser is unable to parse the response"),v.parse=!0,v.original=K,g.xhr?(v.rawResponse=typeof g.xhr.responseType>"u"?g.xhr.responseText:g.xhr.response,v.status=g.xhr.status?g.xhr.status:null,v.statusCode=v.status):(v.rawResponse=null,v.status=null),g.callback(v)}g.emit("response",I);var S;try{g._isResponseOK(I)||(S=new Error(I.statusText||I.text||"Unsuccessful HTTP response"))}catch(K){S=K}S?(S.original=v,S.response=I,S.status=I.status,g.callback(S,I)):g.callback(null,I)})}i(P.prototype),a(P.prototype),P.prototype.type=function(c){return this.set("Content-Type",E.types[c]||c),this},P.prototype.accept=function(c){return this.set("Accept",E.types[c]||c),this},P.prototype.auth=function(c,p,g){arguments.length===1&&(p=""),r(p)==="object"&&p!==null&&(g=p,p=""),g||(g={type:typeof btoa=="function"?"basic":"auto"});var v=function(S){if(typeof btoa=="function")return btoa(S);throw new Error("Cannot use basic auth, btoa is not a function")};return this._auth(c,p,g,v)},P.prototype.query=function(c){return typeof c!="string"&&(c=M(c)),c&&this._query.push(c),this},P.prototype.attach=function(c,p,g){if(p){if(this._data)throw new Error("superagent can't mix .send() and .attach()");this._getFormData().append(c,p,g||p.name)}return this},P.prototype._getFormData=function(){return this._formData||(this._formData=new n.FormData),this._formData},P.prototype.callback=function(c,p){if(this._shouldRetry(c,p))return this._retry();var g=this._callback;this.clearTimeout(),c&&(this._maxRetries&&(c.retries=this._retries-1),this.emit("error",c)),g(c,p)},P.prototype.crossDomainError=function(){var c=new Error(`Request has been terminated
Possible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.`);c.crossDomain=!0,c.status=this.status,c.method=this.method,c.url=this.url,this.callback(c)},P.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},P.prototype.ca=P.prototype.agent,P.prototype.buffer=P.prototype.ca,P.prototype.write=function(){throw new Error("Streaming is not supported in browser version of superagent")},P.prototype.pipe=P.prototype.write,P.prototype._isHost=function(c){return c&&r(c)==="object"&&!Array.isArray(c)&&Object.prototype.toString.call(c)!=="[object Object]"},P.prototype.end=function(c){this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=c||C,this._finalizeQueryString(),this._end()},P.prototype._setUploadTimeout=function(){var c=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout(function(){c._timeoutError("Upload timeout of ",c._uploadTimeout,"ETIMEDOUT")},this._uploadTimeout))},P.prototype._end=function(){if(this._aborted)return this.callback(new Error("The request has been aborted even before .end() was called"));var c=this;this.xhr=E.getXHR();var p=this.xhr,g=this._formData||this._data;this._setTimeouts(),p.onreadystatechange=function(){var w=p.readyState;if(w>=2&&c._responseTimeoutTimer&&clearTimeout(c._responseTimeoutTimer),w===4){var H;try{H=p.status}catch{H=0}if(!H)return c.timedout||c._aborted?void 0:c.crossDomainError();c.emit("end")}};var v=function(H,j){j.total>0&&(j.percent=j.loaded/j.total*100,j.percent===100&&clearTimeout(c._uploadTimeoutTimer)),j.direction=H,c.emit("progress",j)};if(this.hasListeners("progress"))try{p.addEventListener("progress",v.bind(null,"download")),p.upload&&p.upload.addEventListener("progress",v.bind(null,"upload"))}catch{}p.upload&&this._setUploadTimeout();try{this.username&&this.password?p.open(this.method,this.url,!0,this.username,this.password):p.open(this.method,this.url,!0)}catch(w){return this.callback(w)}if(this._withCredentials&&(p.withCredentials=!0),!this._formData&&this.method!=="GET"&&this.method!=="HEAD"&&typeof g!="string"&&!this._isHost(g)){var I=this._header["content-type"],S=this._serializer||E.serialize[I?I.split(";")[0]:""];!S&&B(I)&&(S=E.serialize["application/json"]),S&&(g=S(g))}for(var K in this.header)this.header[K]!==null&&Object.prototype.hasOwnProperty.call(this.header,K)&&p.setRequestHeader(K,this.header[K]);this._responseType&&(p.responseType=this._responseType),this.emit("request",this),p.send(typeof g>"u"?null:g)},E.agent=function(){return new _},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach(function(c){_.prototype[c.toLowerCase()]=function(p,g){var v=new E.Request(c,p);return this._setDefaults(v),g&&v.end(g),v}}),_.prototype.del=_.prototype.delete,E.get=function(c,p,g){var v=E("GET",c);return typeof p=="function"&&(g=p,p=null),p&&v.query(p),g&&v.end(g),v},E.head=function(c,p,g){var v=E("HEAD",c);return typeof p=="function"&&(g=p,p=null),p&&v.query(p),g&&v.end(g),v},E.options=function(c,p,g){var v=E("OPTIONS",c);return typeof p=="function"&&(g=p,p=null),p&&v.send(p),g&&v.end(g),v};function Y(c,p,g){var v=E("DELETE",c);return typeof p=="function"&&(g=p,p=null),p&&v.send(p),g&&v.end(g),v}E.del=Y,E.delete=Y,E.patch=function(c,p,g){var v=E("PATCH",c);return typeof p=="function"&&(g=p,p=null),p&&v.send(p),g&&v.end(g),v},E.post=function(c,p,g){var v=E("POST",c);return typeof p=="function"&&(g=p,p=null),p&&v.send(p),g&&v.end(g),v},E.put=function(c,p,g){var v=E("PUT",c);return typeof p=="function"&&(g=p,p=null),p&&v.send(p),g&&v.end(g),v}})(kt,kt.exports);var mn=kt.exports;function Er(t,e){this.name="WebapiError",this.message=t||"",this.statusCode=e}Er.prototype=Error.prototype;var Pr=Er;const et=mn,st=Pr,we={},ht=function(t){const e={};return t.getQueryParameters()&&(e.query=t.getQueryParameters()),t.getHeaders()&&t.getHeaders()["Content-Type"]==="application/json"?e.data=JSON.stringify(t.getBodyParameters()):t.getBodyParameters()&&(e.data=t.getBodyParameters()),t.getHeaders()&&(e.headers=t.getHeaders()),e},yn=function(t,e){let r;if(typeof e.error=="object"&&typeof e.error.message=="string")r=new st(e.error.message,e.error.status);else if(typeof e.error=="string")r=new st(`${e.error}: ${e.error_description}`);else if(typeof e=="string")try{const n=JSON.parse(e);r=new st(n.error.message,n.error.status)}catch{}return r||(r=new st(`${t}: ${JSON.stringify(e)}`)),r};we._makeRequest=function(t,e,r,n){const i=t.bind(et)(r);e.query&&i.query(e.query),e.data&&(!e.headers||e.headers["Content-Type"]!=="application/json")?(i.type("form"),i.send(e.data)):e.data&&i.send(e.data),e.headers&&i.set(e.headers),i.end((s,a)=>{if(s){const l=yn("Request error",{error:s});return n(l)}return n(null,{body:a.body,headers:a.headers,statusCode:a.statusCode})})};we.get=function(t,e){const r=ht(t),n=et.get;we._makeRequest(n,r,t.getURI(),e)};we.post=function(t,e){const r=ht(t),n=et.post;we._makeRequest(n,r,t.getURI(),e)};we.del=function(t,e){const r=ht(t),n=et.del;we._makeRequest(n,r,t.getURI(),e)};we.put=function(t,e){const r=ht(t),n=et.put;we._makeRequest(n,r,t.getURI(),e)};var Se=we;const ge=Pe,me=Se,{sortParameters:ye}=Ee;function bn(t,e,r,n){const[i,s,a]=ye(["object","function","object"],[e,r,n]);return ge.builder().withPath(`/pub/player/${t}`).withQueryParameters(i).withHeaders(a).build().execute(me.get,s)}function vn(t,e,r,n){const[i,s,a]=ye(["object","function","object"],[e,r,n]);return ge.builder().withPath(`/pub/player/${t}/stats`).withQueryParameters(i).withHeaders(a).build().execute(me.get,s)}function wn(t,e,r,n){return new Error("This endpoint was removed by Chess.com, please see https://github.com/andyruwruw/chess-web-api/tree/master#getplayeronlineusername-options-callback")}function En(t,e,r,n){const[i,s,a]=ye(["object","function","object"],[e,r,n]);return ge.builder().withPath(`/pub/player/${t}/games`).withQueryParameters(i).withHeaders(a).build().execute(me.get,s)}function Pn(t,e,r,n){const[i,s,a]=ye(["object","function","object"],[e,r,n]);return ge.builder().withPath(`/pub/player/${t}/games/to-move`).withQueryParameters(i).withHeaders(a).build().execute(me.get,s)}function Tn(t,e,r,n){const[i,s,a]=ye(["object","function","object"],[e,r,n]);return ge.builder().withPath(`/pub/player/${t}/games/archives`).withQueryParameters(i).withHeaders(a).build().execute(me.get,s)}function Sn(t,e,r,n,i,s){const[a,l,d]=ye(["object","function","object"],[n,i,s]);let _;return typeof r=="number"&&r<10||typeof r=="string"&&r.length===1?_=`0${r}`:_=`${r}`,ge.builder().withPath(`/pub/player/${t}/games/${e}/${_}`).withQueryParameters(a).withHeaders(d).build().execute(me.get,l)}function Cn(t,e,r,n,i,s){const[a,l,d]=ye(["object","function","object"],[n,i,s]);let _;return typeof r=="number"&&r<10||typeof r=="string"&&r.length===1?_=`0${r}`:_=`${r}`,ge.builder().withPath(`/pub/player/${t}/games/${e}/${_}/pgn`).withQueryParameters(a).withHeaders(d).build().execute(me.get,l)}function An(t,e,r,n){const[i,s,a]=ye(["object","function","object"],[e,r,n]);return ge.builder().withPath(`/pub/player/${t}/clubs`).withQueryParameters(i).withHeaders(a).build().execute(me.get,s)}function Rn(t,e,r,n){const[i,s,a]=ye(["object","function","object"],[e,r,n]);return ge.builder().withPath(`/pub/player/${t}/matches`).withQueryParameters(i).withHeaders(a).build().execute(me.get,s)}function On(t,e,r,n){const[i,s,a]=ye(["object","function","object"],[e,r,n]);return ge.builder().withPath(`/pub/player/${t}/tournaments`).withQueryParameters(i).withHeaders(a).build().execute(me.get,s)}function kn(t,e,r,n){const[i,s,a]=ye(["object","function","object"],[e,r,n]);return ge.builder().withPath(`/pub/titled/${t}`).withQueryParameters(i).withHeaders(a).build().execute(me.get,s)}var In={getPlayer:bn,getPlayerStats:vn,getPlayerOnline:wn,getPlayerCurrentDailyChess:En,getPlayerToMoveDailyChess:Pn,getPlayerMonthlyArchives:Tn,getPlayerCompleteMonthlyArchives:Sn,getPlayerMultiGamePGN:Cn,getPlayerClubs:An,getPlayerMatches:Rn,getPlayerTournaments:On,getTitledPlayers:kn};const Dt=Pe,jt=Se,{sortParameters:Ht}=Ee;function qn(t,e,r,n){const[i,s,a]=Ht(["object","function","object"],[e,r,n]);return Dt.builder().withPath(`/pub/club/${t}`).withQueryParameters(i).withHeaders(a).build().execute(jt.get,s)}function xn(t,e,r,n){const[i,s,a]=Ht(["object","function","object"],[e,r,n]);return Dt.builder().withPath(`/pub/club/${t}/members`).withQueryParameters(i).withHeaders(a).build().execute(jt.get,s)}function $n(t,e,r,n){const[i,s,a]=Ht(["object","function","object"],[e,r,n]);return Dt.builder().withPath(`/pub/club/${t}/matches`).withQueryParameters(i).withHeaders(a).build().execute(jt.get,s)}var Ln={getClub:qn,getClubMembers:xn,getClubMatches:$n};const Qt=Pe,Ut=Se,{sortParameters:Kt}=Ee;function Nn(t,e,r,n){const[i,s,a]=Kt(["object","function","object"],[e,r,n]);return Qt.builder().withPath(`/pub/tournament/${t}`).withQueryParameters(i).withHeaders(a).build().execute(Ut.get,s)}function Mn(t,e,r,n,i){const[s,a,l]=Kt(["object","function","object"],[r,n,i]);return Qt.builder().withPath(`/pub/tournament/${t}/${e}`).withQueryParameters(s).withHeaders(l).build().execute(Ut.get,a)}function Dn(t,e,r,n,i,s){const[a,l,d]=Kt(["object","function","object"],[n,i,s]);return Qt.builder().withPath(`/pub/tournament/${t}/${e}/${r}`).withQueryParameters(a).withHeaders(d).build().execute(Ut.get,l)}var jn={getTournament:Nn,getTournamentRound:Mn,getTournamentRoundGroup:Dn};const pt=Pe,dt=Se,{sortParameters:_t}=Ee;function Hn(t,e,r,n){const[i,s,a]=_t(["object","function","object"],[e,r,n]);return pt.builder().withPath(`/pub/match/${t}`).withQueryParameters(i).withHeaders(a).build().execute(dt.get,s)}function Qn(t,e,r,n,i){const[s,a,l]=_t(["object","function","object"],[r,n,i]);return pt.builder().withPath(`/pub/match/${t}/${e}`).withQueryParameters(s).withHeaders(l).build().execute(dt.get,a)}function Un(t,e,r,n){const[i,s,a]=_t(["object","function","object"],[e,r,n]);return pt.builder().withPath(`/pub/match/live/${t}`).withQueryParameters(i).withHeaders(a).build().execute(dt.get,s)}function Kn(t,e,r,n,i){const[s,a,l]=_t(["object","function","object"],[r,n,i]);return pt.builder().withPath(`/pub/match/live/${t}/${e}`).withQueryParameters(s).withHeaders(l).build().execute(dt.get,a)}var Bn={getTeamMatch:Hn,getTeamMatchBoard:Qn,getTeamLiveMatch:Un,getTeamLiveMatchBoard:Kn};const Bt=Pe,Ft=Se,{sortParameters:Gt}=Ee;function Fn(t,e,r,n){const[i,s,a]=Gt(["object","function","object"],[e,r,n]);return Bt.builder().withPath(`/pub/country/${t}`).withQueryParameters(i).withHeaders(a).build().execute(Ft.get,s)}function Gn(t,e,r,n){const[i,s,a]=Gt(["object","function","object"],[e,r,n]);return Bt.builder().withPath(`/pub/country/${t}/players`).withQueryParameters(i).withHeaders(a).build().execute(Ft.get,s)}function Wn(t,e,r,n){const[i,s,a]=Gt(["object","function","object"],[e,r,n]);return Bt.builder().withPath(`/pub/country/${t}/clubs`).withQueryParameters(i).withHeaders(a).build().execute(Ft.get,s)}var zn={getCountry:Fn,getCountryPlayers:Gn,getCountryClubs:Wn};const Tr=Pe,Sr=Se,{sortParameters:Cr}=Ee;function Xn(t,e,r){const[n,i,s]=Cr(["object","function","object"],[t,e,r]);return Tr.builder().withPath("/pub/puzzle").withQueryParameters(n).withHeaders(s).build().execute(Sr.get,i)}function Jn(t,e,r){const[n,i,s]=Cr(["object","function","object"],[t,e,r]);return Tr.builder().withPath("/pub/puzzle/random").withQueryParameters(n).withHeaders(s).build().execute(Sr.get,i)}var Yn={getDailyPuzzle:Xn,getDailyPuzzleRandom:Jn};const Zn=Pe,Vn=Se,{sortParameters:ei}=Ee;function ti(t,e,r){const[n,i,s]=ei(["object","function","object"],[t,e,r]);return Zn.builder().withPath("/pub/streamers").withQueryParameters(n).withHeaders(s).build().execute(Vn.get,i)}var ri={getStreamers:ti};const ni=Pe,ii=Se,{sortParameters:si}=Ee;function oi(t,e,r){const[n,i,s]=si(["object","function","object"],[t,e,r]);return ni.builder().withPath("/pub/leaderboards").withQueryParameters(n).withHeaders(s).build().execute(ii.get,i)}var ai={getLeaderboards:oi},Ar={};(function(t){var e=function(r){var n="b",i="w",s=-1,a="p",l="n",d="b",_="r",C="q",E="k",b="pnbrqkPNBRQK",M="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",T=["1-0","0-1","1/2-1/2","*"],k={b:[16,32,17,15],w:[-16,-32,-17,-15]},D={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},B=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],ae=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],P={p:0,n:1,b:2,r:3,q:4,k:5},Y={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},c={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},p=7,g=6,v=1,I=0,S={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},K={w:[{square:S.a1,flag:c.QSIDE_CASTLE},{square:S.h1,flag:c.KSIDE_CASTLE}],b:[{square:S.a8,flag:c.QSIDE_CASTLE},{square:S.h8,flag:c.KSIDE_CASTLE}]},w=new Array(128),H={w:s,b:s},j=i,F={w:0,b:0},de=s,be=0,Ce=1,Te=[],ue={},re={};Be(typeof r>"u"?M:r);function zt(o){typeof o>"u"&&(o=!1),w=new Array(128),H={w:s,b:s},j=i,F={w:0,b:0},de=s,be=0,Ce=1,Te=[],o||(ue={}),re={},tt(oe())}function Xt(){for(var o=[],u={},f=function(h){h in re&&(u[h]=re[h])};Te.length>0;)o.push(Ae());for(f(oe());o.length>0;)ve(o.pop()),f(oe());re=u}function Jt(){Be(M)}function Be(o,u){typeof u>"u"&&(u=!1);var f=o.split(/\s+/),h=f[0],m=0;if(!Yt(o).valid)return!1;zt(u);for(var y=0;y<h.length;y++){var A=h.charAt(y);if(A==="/")m+=8;else if($r(A))m+=parseInt(A,10);else{var L=A<"a"?i:n;Vt({type:A.toLowerCase(),color:L},he(m)),m++}}return j=f[1],f[2].indexOf("K")>-1&&(F.w|=c.KSIDE_CASTLE),f[2].indexOf("Q")>-1&&(F.w|=c.QSIDE_CASTLE),f[2].indexOf("k")>-1&&(F.b|=c.KSIDE_CASTLE),f[2].indexOf("q")>-1&&(F.b|=c.QSIDE_CASTLE),de=f[3]==="-"?s:S[f[3]],be=parseInt(f[4],10),Ce=parseInt(f[5],10),tt(oe()),!0}function Yt(o){var u={0:"No errors.",1:"FEN string must contain six space-delimited fields.",2:"6th field (move number) must be a positive integer.",3:"5th field (half move counter) must be a non-negative integer.",4:"4th field (en-passant square) is invalid.",5:"3rd field (castling availability) is invalid.",6:"2nd field (side to move) is invalid.",7:"1st field (piece positions) does not contain 8 '/'-delimited rows.",8:"1st field (piece positions) is invalid [consecutive numbers].",9:"1st field (piece positions) is invalid [invalid piece].",10:"1st field (piece positions) is invalid [row too large].",11:"Illegal en-passant square"},f=o.split(/\s+/);if(f.length!==6)return{valid:!1,error_number:1,error:u[1]};if(isNaN(f[5])||parseInt(f[5],10)<=0)return{valid:!1,error_number:2,error:u[2]};if(isNaN(f[4])||parseInt(f[4],10)<0)return{valid:!1,error_number:3,error:u[3]};if(!/^(-|[abcdefgh][36])$/.test(f[3]))return{valid:!1,error_number:4,error:u[4]};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(f[2]))return{valid:!1,error_number:5,error:u[5]};if(!/^(w|b)$/.test(f[1]))return{valid:!1,error_number:6,error:u[6]};var h=f[0].split("/");if(h.length!==8)return{valid:!1,error_number:7,error:u[7]};for(var m=0;m<h.length;m++){for(var y=0,A=!1,L=0;L<h[m].length;L++)if(isNaN(h[m][L])){if(!/^[prnbqkPRNBQK]$/.test(h[m][L]))return{valid:!1,error_number:9,error:u[9]};y+=1,A=!1}else{if(A)return{valid:!1,error_number:8,error:u[8]};y+=parseInt(h[m][L],10),A=!0}if(y!==8)return{valid:!1,error_number:10,error:u[10]}}return f[3][1]=="3"&&f[1]=="w"||f[3][1]=="6"&&f[1]=="b"?{valid:!1,error_number:11,error:u[11]}:{valid:!0,error_number:0,error:u[0]}}function oe(){for(var o=0,u="",f=S.a8;f<=S.h1;f++){if(w[f]==null)o++;else{o>0&&(u+=o,o=0);var h=w[f].color,m=w[f].type;u+=h===i?m.toUpperCase():m.toLowerCase()}f+1&136&&(o>0&&(u+=o),f!==S.h1&&(u+="/"),o=0,f+=8)}var y="";F[i]&c.KSIDE_CASTLE&&(y+="K"),F[i]&c.QSIDE_CASTLE&&(y+="Q"),F[n]&c.KSIDE_CASTLE&&(y+="k"),F[n]&c.QSIDE_CASTLE&&(y+="q"),y=y||"-";var A=de===s?"-":he(de);return[u,j,y,A,be,Ce].join(" ")}function gt(o){for(var u=0;u<o.length;u+=2)typeof o[u]=="string"&&typeof o[u+1]=="string"&&(ue[o[u]]=o[u+1]);return ue}function tt(o){Te.length>0||(o!==M?(ue.SetUp="1",ue.FEN=o):(delete ue.SetUp,delete ue.FEN))}function Zt(o){var u=w[S[o]];return u?{type:u.type,color:u.color}:null}function Vt(o,u){if(!("type"in o&&"color"in o)||b.indexOf(o.type.toLowerCase())===-1||!(u in S))return!1;var f=S[u];return o.type==E&&!(H[o.color]==s||H[o.color]==f)?!1:(w[f]={type:o.type,color:o.color},o.type===E&&(H[o.color]=f),tt(oe()),!0)}function kr(o){var u=Zt(o);return w[S[o]]=null,u&&u.type===E&&(H[u.color]=s),tt(oe()),u}function er(o,u,f,h,m){var y={color:j,from:u,to:f,flags:h,piece:o[u].type};return m&&(y.flags|=c.PROMOTION,y.promotion=m),o[f]?y.captured=o[f].type:h&c.EP_CAPTURE&&(y.captured=a),y}function $e(o){function u(Oe,ke,Q,ie,Ue){if(Oe[Q].type===a&&(Re(ie)===I||Re(ie)===p))for(var We=[C,_,d,l],Ne=0,ze=We.length;Ne<ze;Ne++)ke.push(er(Oe,Q,ie,Ue,We[Ne]));else ke.push(er(Oe,Q,ie,Ue))}var f=[],h=j,m=Ge(h),y={b:v,w:g},A=S.a8,L=S.h1,q=!1,x=typeof o<"u"&&"legal"in o?o.legal:!0;if(typeof o<"u"&&"square"in o)if(o.square in S)A=L=S[o.square],q=!0;else return[];for(var N=A;N<=L;N++){if(N&136){N+=7;continue}var ne=w[N];if(!(ne==null||ne.color!==h))if(ne.type===a){var U=N+k[h][0];if(w[U]==null){u(w,f,N,U,c.NORMAL);var U=N+k[h][1];y[h]===Re(N)&&w[U]==null&&u(w,f,N,U,c.BIG_PAWN)}for(G=2;G<4;G++){var U=N+k[h][G];U&136||(w[U]!=null&&w[U].color===m?u(w,f,N,U,c.CAPTURE):U===de&&u(w,f,N,de,c.EP_CAPTURE))}}else for(var G=0,z=D[ne.type].length;G<z;G++)for(var ee=D[ne.type][G],U=N;U+=ee,!(U&136);){if(w[U]==null)u(w,f,N,U,c.NORMAL);else{if(w[U].color===h)break;u(w,f,N,U,c.CAPTURE);break}if(ne.type==="n"||ne.type==="k")break}}if(!q||L===H[h]){if(F[h]&c.KSIDE_CASTLE){var X=H[h],te=X+2;w[X+1]==null&&w[te]==null&&!Le(m,H[h])&&!Le(m,X+1)&&!Le(m,te)&&u(w,f,H[h],te,c.KSIDE_CASTLE)}if(F[h]&c.QSIDE_CASTLE){var X=H[h],te=X-2;w[X-1]==null&&w[X-2]==null&&w[X-3]==null&&!Le(m,H[h])&&!Le(m,X-1)&&!Le(m,te)&&u(w,f,H[h],te,c.QSIDE_CASTLE)}}if(!x)return f;for(var le=[],N=0,z=f.length;N<z;N++)ve(f[N]),yt(h)||le.push(f[N]),Ae();return le}function Qe(o,u){var f="";if(o.flags&c.KSIDE_CASTLE)f="O-O";else if(o.flags&c.QSIDE_CASTLE)f="O-O-O";else{var h=qr(o,u);o.piece!==a&&(f+=o.piece.toUpperCase()+h),o.flags&(c.CAPTURE|c.EP_CAPTURE)&&(o.piece===a&&(f+=he(o.from)[0]),f+="x"),f+=he(o.to),o.flags&c.PROMOTION&&(f+="="+o.promotion.toUpperCase())}return ve(o),rt()&&(bt()?f+="#":f+="+"),Ae(),f}function mt(o){return o.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function Le(o,u){for(var f=S.a8;f<=S.h1;f++){if(f&136){f+=7;continue}if(!(w[f]==null||w[f].color!==o)){var h=w[f],m=f-u,y=m+119;if(B[y]&1<<P[h.type]){if(h.type===a){if(m>0){if(h.color===i)return!0}else if(h.color===n)return!0;continue}if(h.type==="n"||h.type==="k")return!0;for(var A=ae[y],L=f+A,q=!1;L!==u;){if(w[L]!=null){q=!0;break}L+=A}if(!q)return!0}}}return!1}function yt(o){return Le(Ge(o),H[o])}function rt(){return yt(j)}function bt(){return rt()&&$e().length===0}function vt(){return!rt()&&$e().length===0}function wt(){for(var o={},u=[],f=0,h=0,m=S.a8;m<=S.h1;m++){if(h=(h+1)%2,m&136){m+=7;continue}var y=w[m];y&&(o[y.type]=y.type in o?o[y.type]+1:1,y.type===d&&u.push(h),f++)}if(f===2)return!0;if(f===3&&(o[d]===1||o[l]===1))return!0;if(f===o[d]+2){for(var A=0,L=u.length,m=0;m<L;m++)A+=u[m];if(A===0||A===L)return!0}return!1}function Et(){for(var o=[],u={},f=!1;;){var h=Ae();if(!h)break;o.push(h)}for(;;){var m=oe().split(" ").slice(0,4).join(" ");if(u[m]=m in u?u[m]+1:1,u[m]>=3&&(f=!0),!o.length)break;ve(o.pop())}return f}function Ir(o){Te.push({move:o,kings:{b:H.b,w:H.w},turn:j,castling:{b:F.b,w:F.w},ep_square:de,half_moves:be,move_number:Ce})}function ve(o){var u=j,f=Ge(u);if(Ir(o),w[o.to]=w[o.from],w[o.from]=null,o.flags&c.EP_CAPTURE&&(j===n?w[o.to-16]=null:w[o.to+16]=null),o.flags&c.PROMOTION&&(w[o.to]={type:o.promotion,color:u}),w[o.to].type===E){if(H[w[o.to].color]=o.to,o.flags&c.KSIDE_CASTLE){var h=o.to-1,m=o.to+1;w[h]=w[m],w[m]=null}else if(o.flags&c.QSIDE_CASTLE){var h=o.to+1,m=o.to-2;w[h]=w[m],w[m]=null}F[u]=""}if(F[u]){for(var y=0,A=K[u].length;y<A;y++)if(o.from===K[u][y].square&&F[u]&K[u][y].flag){F[u]^=K[u][y].flag;break}}if(F[f]){for(var y=0,A=K[f].length;y<A;y++)if(o.to===K[f][y].square&&F[f]&K[f][y].flag){F[f]^=K[f][y].flag;break}}o.flags&c.BIG_PAWN?j==="b"?de=o.to-16:de=o.to+16:de=s,o.piece===a||o.flags&(c.CAPTURE|c.EP_CAPTURE)?be=0:be++,j===n&&Ce++,j=Ge(j)}function Ae(){var o=Te.pop();if(o==null)return null;var u=o.move;H=o.kings,j=o.turn,F=o.castling,de=o.ep_square,be=o.half_moves,Ce=o.move_number;var f=j,h=Ge(j);if(w[u.from]=w[u.to],w[u.from].type=u.piece,w[u.to]=null,u.flags&c.CAPTURE)w[u.to]={type:u.captured,color:h};else if(u.flags&c.EP_CAPTURE){var m;f===n?m=u.to-16:m=u.to+16,w[m]={type:a,color:h}}if(u.flags&(c.KSIDE_CASTLE|c.QSIDE_CASTLE)){var y,A;u.flags&c.KSIDE_CASTLE?(y=u.to+1,A=u.to-1):u.flags&c.QSIDE_CASTLE&&(y=u.to-2,A=u.to+1),w[y]=w[A],w[A]=null}return u}function qr(o,u){for(var f=$e({legal:!u}),h=o.from,m=o.to,y=o.piece,A=0,L=0,q=0,x=0,N=f.length;x<N;x++){var ne=f[x].from,U=f[x].to,G=f[x].piece;y===G&&h!==ne&&m===U&&(A++,Re(h)===Re(ne)&&L++,Fe(h)===Fe(ne)&&q++)}return A>0?L>0&&q>0?he(h):q>0?he(h).charAt(1):he(h).charAt(0):""}function xr(){for(var o=`   +------------------------+
`,u=S.a8;u<=S.h1;u++){if(Fe(u)===0&&(o+=" "+"87654321"[Re(u)]+" |"),w[u]==null)o+=" . ";else{var f=w[u].type,h=w[u].color,m=h===i?f.toUpperCase():f.toLowerCase();o+=" "+m+" "}u+1&136&&(o+=`|
`,u+=8)}return o+=`   +------------------------+
`,o+=`     a  b  c  d  e  f  g  h
`,o}function Pt(o,u){var f=mt(o);if(u){var h=f.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/);if(h)var m=h[1],y=h[2],A=h[3],L=h[4]}for(var q=$e(),x=0,N=q.length;x<N;x++){if(f===mt(Qe(q[x]))||u&&f===mt(Qe(q[x],!0)))return q[x];if(h&&(!m||m.toLowerCase()==q[x].piece)&&S[y]==q[x].from&&S[A]==q[x].to&&(!L||L.toLowerCase()==q[x].promotion))return q[x]}return null}function Re(o){return o>>4}function Fe(o){return o&15}function he(o){var u=Fe(o),f=Re(o);return"abcdefgh".substring(u,u+1)+"87654321".substring(f,f+1)}function Ge(o){return o===i?n:i}function $r(o){return"0123456789".indexOf(o)!==-1}function nt(o){var u=tr(o);u.san=Qe(u,!1),u.to=he(u.to),u.from=he(u.from);var f="";for(var h in c)c[h]&u.flags&&(f+=Y[h]);return u.flags=f,u}function tr(o){var u=o instanceof Array?[]:{};for(var f in o)typeof f=="object"?u[f]=tr(o[f]):u[f]=o[f];return u}function rr(o){return o.replace(/^\s+|\s+$/g,"")}function nr(o){for(var u=$e({legal:!1}),f=0,h=j,m=0,y=u.length;m<y;m++){if(ve(u[m]),!yt(h))if(o-1>0){var A=nr(o-1);f+=A}else f++;Ae()}return f}return{WHITE:i,BLACK:n,PAWN:a,KNIGHT:l,BISHOP:d,ROOK:_,QUEEN:C,KING:E,SQUARES:function(){for(var o=[],u=S.a8;u<=S.h1;u++){if(u&136){u+=7;continue}o.push(he(u))}return o}(),FLAGS:Y,load:function(o){return Be(o)},reset:function(){return Jt()},moves:function(o){for(var u=$e(o),f=[],h=0,m=u.length;h<m;h++)typeof o<"u"&&"verbose"in o&&o.verbose?f.push(nt(u[h])):f.push(Qe(u[h],!1));return f},in_check:function(){return rt()},in_checkmate:function(){return bt()},in_stalemate:function(){return vt()},in_draw:function(){return be>=100||vt()||wt()||Et()},insufficient_material:function(){return wt()},in_threefold_repetition:function(){return Et()},game_over:function(){return be>=100||bt()||vt()||wt()||Et()},validate_fen:function(o){return Yt(o)},fen:function(){return oe()},board:function(){for(var o=[],u=[],f=S.a8;f<=S.h1;f++)w[f]==null?u.push(null):u.push({type:w[f].type,color:w[f].color}),f+1&136&&(o.push(u),u=[],f+=8);return o},pgn:function(o){var u=typeof o=="object"&&typeof o.newline_char=="string"?o.newline_char:`
`,f=typeof o=="object"&&typeof o.max_width=="number"?o.max_width:0,h=[],m=!1;for(var y in ue)h.push("["+y+' "'+ue[y]+'"]'+u),m=!0;m&&Te.length&&h.push(u);for(var A=function(z){var ee=re[oe()];if(typeof ee<"u"){var X=z.length>0?" ":"";z=`${z}${X}{${ee}}`}return z},L=[];Te.length>0;)L.push(Ae());var q=[],x="";for(L.length===0&&q.push(A(""));L.length>0;){x=A(x);var N=L.pop();!Te.length&&N.color==="b"?x=Ce+". ...":N.color==="w"&&(x.length&&q.push(x),x=Ce+"."),x=x+" "+Qe(N,!1),ve(N)}if(x.length&&q.push(A(x)),typeof ue.Result<"u"&&q.push(ue.Result),f===0)return h.join("")+q.join(" ");for(var ne=function(){return h.length>0&&h[h.length-1]===" "?(h.pop(),!0):!1},U=function(z,ee){for(var X of ee.split(" "))if(X){if(z+X.length>f){for(;ne();)z--;h.push(u),z=0}h.push(X),z+=X.length,h.push(" "),z++}return ne()&&z--,z},G=0,y=0;y<q.length;y++){if(G+q[y].length>f&&q[y].includes("{")){G=U(G,q[y]);continue}G+q[y].length>f&&y!==0?(h[h.length-1]===" "&&h.pop(),h.push(u),G=0):y!==0&&(h.push(" "),G++),h.push(q[y]),G+=q[y].length}return h.join("")},load_pgn:function(o,u){var f=typeof u<"u"&&"sloppy"in u?u.sloppy:!1;function h(Q){return Q.replace(/\\/g,"\\")}function m(Q){for(var ie in Q)return!0;return!1}function y(Q,ie){for(var Ue=typeof ie=="object"&&typeof ie.newline_char=="string"?ie.newline_char:`\r?
`,We={},Ne=Q.split(new RegExp(h(Ue))),ze="",ir="",it=0;it<Ne.length;it++)ze=Ne[it].replace(/^\[([A-Z][A-Za-z]*)\s.*\]$/,"$1"),ir=Ne[it].replace(/^\[[A-Za-z]+\s"(.*)"\ *\]$/,"$1"),rr(ze).length>0&&(We[ze]=ir);return We}var A=typeof u=="object"&&typeof u.newline_char=="string"?u.newline_char:`\r?
`,L=new RegExp("^(\\[((?:"+h(A)+")|.)*\\])(?:"+h(A)+"){2}"),q=L.test(o)?L.exec(o)[1]:"";Jt();var x=y(q,u);for(var N in x)gt([N,x[N]]);if(x.SetUp==="1"&&!("FEN"in x&&Be(x.FEN,!0)))return!1;for(var ne=function(Q){return Array.from(Q).map(function(ie){return ie.charCodeAt(0)<128?ie.charCodeAt(0).toString(16):encodeURIComponent(ie).replace(/\%/g,"").toLowerCase()}).join("")},U=function(Q){return Q.length==0?"":decodeURIComponent("%"+Q.match(/.{1,2}/g).join("%"))},G=function(Q){return Q=Q.replace(new RegExp(h(A),"g")," "),`{${ne(Q.slice(1,Q.length-1))}}`},z=function(Q){if(Q.startsWith("{")&&Q.endsWith("}"))return U(Q.slice(1,Q.length-1))},ee=o.replace(q,"").replace(new RegExp(`({[^}]*})+?|;([^${h(A)}]*)`,"g"),function(Q,ie,Ue){return ie!==void 0?G(ie):" "+G(`{${Ue.slice(1)}}`)}).replace(new RegExp(h(A),"g")," "),X=/(\([^\(\)]+\))+?/g;X.test(ee);)ee=ee.replace(X,"");ee=ee.replace(/\d+\.(\.\.)?/g,""),ee=ee.replace(/\.\.\./g,""),ee=ee.replace(/\$\d+/g,"");var te=rr(ee).split(new RegExp(/\s+/));te=te.join(",").replace(/,,+/g,",").split(",");for(var le="",Oe=0;Oe<te.length-1;Oe++){var ke=z(te[Oe]);if(ke!==void 0){re[oe()]=ke;continue}if(le=Pt(te[Oe],f),le==null)return!1;ve(le)}if(ke=z(te[te.length-1]),ke!==void 0&&(re[oe()]=ke,te.pop()),le=te[te.length-1],T.indexOf(le)>-1)m(ue)&&typeof ue.Result>"u"&&gt(["Result",le]);else{if(le=Pt(le,f),le==null)return!1;ve(le)}return!0},header:function(){return gt(arguments)},ascii:function(){return xr()},turn:function(){return j},move:function(o,u){var f=typeof u<"u"&&"sloppy"in u?u.sloppy:!1,h=null;if(typeof o=="string")h=Pt(o,f);else if(typeof o=="object"){for(var m=$e(),y=0,A=m.length;y<A;y++)if(o.from===he(m[y].from)&&o.to===he(m[y].to)&&(!("promotion"in m[y])||o.promotion===m[y].promotion)){h=m[y];break}}if(!h)return null;var L=nt(h);return ve(h),L},undo:function(){var o=Ae();return o?nt(o):null},clear:function(){return zt()},put:function(o,u){return Vt(o,u)},get:function(o){return Zt(o)},remove:function(o){return kr(o)},perft:function(o){return nr(o)},square_color:function(o){if(o in S){var u=S[o];return(Re(u)+Fe(u))%2===0?"light":"dark"}return null},history:function(o){for(var u=[],f=[],h=typeof o<"u"&&("verbose"in o)&&o.verbose;Te.length>0;)u.push(Ae());for(;u.length>0;){var m=u.pop();h?f.push(nt(m)):f.push(Qe(m)),ve(m)}return f},get_comment:function(){return re[oe()]},set_comment:function(o){re[oe()]=o.replace("{","[").replace("}","]")},delete_comment:function(){var o=re[oe()];return delete re[oe()],o},get_comments:function(){return Xt(),Object.keys(re).map(function(o){return{fen:o,comment:re[o]}})},delete_comments:function(){return Xt(),Object.keys(re).map(function(o){var u=re[o];return delete re[o],{fen:o,comment:u}})}}};t.Chess=e})(Ar);const{Chess:or}=Ar,ui=Pe,ar=Se,ur=Pr,{sortParameters:li}=Ee,ci="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!?",$t="abcdefgh",Lt=8,fi="#@$_[]^()~{}",hi="brnq",pi=4,St=3,di=1,_i=2,gi="chess.com",lr="Result missing or empty.";function Wt(t){const e=Math.floor(t/St);if(e>pi-1)throw new Error(`Pawn promotion row index out of bounds: ${e}`);this.piece=hi[e],this.isCaptureLeft=t%St===di,this.isCaptureRight=t%St===_i}Wt.prototype.getTo=function(t){const e=t[0],r=t[1],n=$t.indexOf(e);let i;if(this.isCaptureLeft?i=n-1:i=this.isCaptureRight?n+1:n,i<0||i>Lt-1)throw new Error(`Invalid pawn promotion; file index out of bounds: ${i}`);const s=$t[i];let a;if(r==="2")a="1";else if(r==="7")a="8";else throw new Error(`Invalid rank prior to pawn promotion: ${r}`);return`${s}${a}`};function cr(t,e){const r=ci.indexOf(t);if(r===-1){if(e){const s=fi.indexOf(t);if(s!==-1)return new Wt(s)}throw new Error(`Unrecognized move-character: ${t}`)}const n=$t[r%Lt],i=Math.floor(r/Lt)+1;return`${n}${i}`}function mi(t,e){const r=e.length;if(r===0||r%2!==0)throw new Error(`Malformed field "game.moveList"; expected non-empty, even-number of characters: ${e}`);const n="FEN"in t?new or(t.FEN):new or;Object.keys(t).forEach(i=>{n.header(i,t[i])});for(let i=0;i<r;i+=2){const s={from:cr(e[i],!1),to:cr(e[i+1],!0)};s.to instanceof Wt&&(s.promotion=s.to.piece,s.to=s.to.getTo(s.from)),n.move(s)}return n.pgn()}function Ct(t,e,r){if(Object.prototype.hasOwnProperty.call(t,e))return t[e];const n=typeof r<"u"?r:e;throw new Error(`Missing required field "${n}"`)}function fr(t){const e=Ct(t,"game"),r=Ct(e,"moveList","game.moveList"),n=Ct(e,"pgnHeaders","game.pgnHeaders");e.pgn=mi(n,r)}function yi(t,e,r,n){const[i,s,a]=li(["object","function","object"],[e,r,n]),l=ui.builder().withHost(gi).withPath(`/callback/live/game/${t}`).withQueryParameters(i).withHeaders(a).build();return s?(ar.get(l,(d,_)=>{if(d)s(d);else if(!_||!Object.prototype.hasOwnProperty.call(_,"body"))s(new ur(lr));else try{fr(_.body),s(null,_)}catch(C){s(C)}}),null):new Promise((d,_)=>{ar.get(l,(C,E)=>{if(C)_(C);else if(!E||!Object.prototype.hasOwnProperty.call(E,"body"))_(new ur(lr));else try{fr(E.body),d(E)}catch(b){_(b)}})})}var bi={getGameByID:yi};const vi=Jr,{getPlayer:wi,getPlayerStats:Ei,getPlayerOnline:Pi,getPlayerCurrentDailyChess:Ti,getPlayerToMoveDailyChess:Si,getPlayerMonthlyArchives:Ci,getPlayerCompleteMonthlyArchives:Ai,getPlayerMultiGamePGN:Ri,getPlayerClubs:Oi,getPlayerMatches:ki,getPlayerTournaments:Ii,getTitledPlayers:qi}=In,{getClub:xi,getClubMembers:$i,getClubMatches:Li}=Ln,{getTournament:Ni,getTournamentRound:Mi,getTournamentRoundGroup:Di}=jn,{getTeamMatch:ji,getTeamMatchBoard:Hi,getTeamLiveMatch:Qi,getTeamLiveMatchBoard:Ui}=Bn,{getCountry:Ki,getCountryPlayers:Bi,getCountryClubs:Fi}=zn,{getDailyPuzzle:Gi,getDailyPuzzleRandom:Wi}=Yn,{getStreamers:zi}=ri,{getLeaderboards:Xi}=ai,{getGameByID:Ji}=bi;function Rr(t){t&&"queue"in t&&t.queue&&(this.addMethods(vi),this.queueSetup())}Rr.prototype={addMethods(t){const e=Object.keys(t);for(let r=0;r<e.length;r+=1)this[e[r]]=t[e[r]]},async ifChanged(t,e,r,n,i){if(!t||typeof t!="string")throw Error("etag required for ifChanged");if(!e||typeof e!="function")throw Error("dispatch requires request function");let s=[],a=null,l={};const d=[r,n,i];for(let _=0;_<d.length;_+=1)d[_]&&(d[_]instanceof Array?s=d[_]:typeof d[_]=="object"?l=d[_]:typeof d[_]=="function"&&(a=d[_]));try{return{changed:!0,response:await e(...s,l,a,{"If-None-Match":t})}}catch{return{changed:!1}}},getPlayer:wi,getPlayerStats:Ei,getPlayerOnline:Pi,getPlayerCurrentDailyChess:Ti,getPlayerToMoveDailyChess:Si,getPlayerMonthlyArchives:Ci,getPlayerCompleteMonthlyArchives:Ai,getPlayerMultiGamePGN:Ri,getPlayerClubs:Oi,getPlayerMatches:ki,getPlayerTournaments:Ii,getTitledPlayers:qi,getClub:xi,getClubMembers:$i,getClubMatches:Li,getTournament:Ni,getTournamentRound:Mi,getTournamentRoundGroup:Di,getTeamMatch:ji,getTeamMatchBoard:Hi,getTeamLiveMatch:Qi,getTeamLiveMatchBoard:Ui,getCountry:Ki,getCountryPlayers:Bi,getCountryClubs:Fi,getDailyPuzzle:Gi,getDailyPuzzleRandom:Wi,getStreamers:zi,getLeaderboards:Xi,getGameByID:Ji};var Yi=Rr;const Zi=Yi;var Vi=Zi;const es=Mr(Vi),Es=new es,ts={},rs=sr("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[sr("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})],-1),ns=[rs];function is(t,e){return jr(),Hr("button",{class:"btn btn-square btn-outline btn-primary absolute top-5 left-5",onClick:e[0]||(e[0]=r=>t.$router.push("/"))},ns)}const Ps=Dr(ts,[["render",is]]);/**
 * @license
 * Copyright (c) 2023, Jeff Hlywa (jhlywa@gmail.com)
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice,
 *    this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */const se="w",pe="b",Z="p",Nt="n",lt="b",Je="r",xe="q",V="k",At="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",ce=-1,ss={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},R={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},O={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},Rt={b:[16,32,17,15],w:[-16,-32,-17,-15]},hr={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},os=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],as=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],us={p:1,n:2,b:4,r:8,q:16,k:32},ls="pnbrqkPNBRQK",pr=[Nt,lt,Je,xe],cs=7,fs=6,hs=1,ps=0,ot={[V]:R.KSIDE_CASTLE,[xe]:R.QSIDE_CASTLE},Ie={w:[{square:O.a1,flag:R.QSIDE_CASTLE},{square:O.h1,flag:R.KSIDE_CASTLE}],b:[{square:O.a8,flag:R.QSIDE_CASTLE},{square:O.h8,flag:R.KSIDE_CASTLE}]},ds={b:hs,w:fs},_s=["1-0","0-1","1/2-1/2","*"];function je(t){return t>>4}function Ze(t){return t&15}function Or(t){return"0123456789".indexOf(t)!==-1}function fe(t){const e=Ze(t),r=je(t);return"abcdefgh".substring(e,e+1)+"87654321".substring(r,r+1)}function Xe(t){return t===se?pe:se}function gs(t){const e=t.split(/\s+/);if(e.length!==6)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};const r=parseInt(e[5],10);if(isNaN(r)||r<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};const n=parseInt(e[4],10);if(isNaN(n)||n<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(e[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(e[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(e[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};const i=e[0].split("/");if(i.length!==8)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let a=0;a<i.length;a++){let l=0,d=!1;for(let _=0;_<i[a].length;_++)if(Or(i[a][_])){if(d)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};l+=parseInt(i[a][_],10),d=!0}else{if(!/^[prnbqkPRNBQK]$/.test(i[a][_]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};l+=1,d=!1}if(l!==8)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if(e[3][1]=="3"&&e[1]=="w"||e[3][1]=="6"&&e[1]=="b")return{ok:!1,error:"Invalid FEN: illegal en-passant square"};const s=[{color:"white",regex:/K/g},{color:"black",regex:/k/g}];for(const{color:a,regex:l}of s){if(!l.test(e[0]))return{ok:!1,error:`Invalid FEN: missing ${a} king`};if((e[0].match(l)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${a} kings`}}return{ok:!0}}function ms(t,e){const r=t.from,n=t.to,i=t.piece;let s=0,a=0,l=0;for(let d=0,_=e.length;d<_;d++){const C=e[d].from,E=e[d].to,b=e[d].piece;i===b&&r!==C&&n===E&&(s++,je(r)===je(C)&&a++,Ze(r)===Ze(C)&&l++)}return s>0?a>0&&l>0?fe(r):l>0?fe(r).charAt(1):fe(r).charAt(0):""}function qe(t,e,r,n,i,s=void 0,a=R.NORMAL){const l=je(n);if(i===Z&&(l===cs||l===ps))for(let d=0;d<pr.length;d++){const _=pr[d];t.push({color:e,from:r,to:n,piece:i,captured:s,promotion:_,flags:a|R.PROMOTION})}else t.push({color:e,from:r,to:n,piece:i,captured:s,flags:a})}function dr(t){let e=t.charAt(0);return e>="a"&&e<="h"?t.match(/[a-h]\d.*[a-h]\d/)?void 0:Z:(e=e.toLowerCase(),e==="o"?V:e)}function Ot(t){return t.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}class Ts{constructor(e=At){_e(this,"_board",new Array(128));_e(this,"_turn",se);_e(this,"_header",{});_e(this,"_kings",{w:ce,b:ce});_e(this,"_epSquare",-1);_e(this,"_halfMoves",0);_e(this,"_moveNumber",0);_e(this,"_history",[]);_e(this,"_comments",{});_e(this,"_castling",{w:0,b:0});this.load(e)}clear(e=!1){this._board=new Array(128),this._kings={w:ce,b:ce},this._turn=se,this._castling={w:0,b:0},this._epSquare=ce,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=e?this._header:{},this._updateSetup(this.fen())}removeHeader(e){e in this._header&&delete this._header[e]}load(e,r=!1){let n=e.split(/\s+/);if(n.length>=2&&n.length<6){const d=["-","-","0","1"];e=n.concat(d.slice(-(6-n.length))).join(" ")}n=e.split(/\s+/);const{ok:i,error:s}=gs(e);if(!i)throw new Error(s);const a=n[0];let l=0;this.clear(r);for(let d=0;d<a.length;d++){const _=a.charAt(d);if(_==="/")l+=8;else if(Or(_))l+=parseInt(_,10);else{const C=_<"a"?se:pe;this.put({type:_.toLowerCase(),color:C},fe(l)),l++}}this._turn=n[1],n[2].indexOf("K")>-1&&(this._castling.w|=R.KSIDE_CASTLE),n[2].indexOf("Q")>-1&&(this._castling.w|=R.QSIDE_CASTLE),n[2].indexOf("k")>-1&&(this._castling.b|=R.KSIDE_CASTLE),n[2].indexOf("q")>-1&&(this._castling.b|=R.QSIDE_CASTLE),this._epSquare=n[3]==="-"?ce:O[n[3]],this._halfMoves=parseInt(n[4],10),this._moveNumber=parseInt(n[5],10),this._updateSetup(this.fen())}fen(){var s,a;let e=0,r="";for(let l=O.a8;l<=O.h1;l++){if(this._board[l]){e>0&&(r+=e,e=0);const{color:d,type:_}=this._board[l];r+=d===se?_.toUpperCase():_.toLowerCase()}else e++;l+1&136&&(e>0&&(r+=e),l!==O.h1&&(r+="/"),e=0,l+=8)}let n="";this._castling[se]&R.KSIDE_CASTLE&&(n+="K"),this._castling[se]&R.QSIDE_CASTLE&&(n+="Q"),this._castling[pe]&R.KSIDE_CASTLE&&(n+="k"),this._castling[pe]&R.QSIDE_CASTLE&&(n+="q"),n=n||"-";let i="-";if(this._epSquare!==ce){const l=this._epSquare+(this._turn===se?16:-16),d=[l+1,l-1];for(const _ of d){if(_&136)continue;const C=this._turn;if(((s=this._board[_])==null?void 0:s.color)===C&&((a=this._board[_])==null?void 0:a.type)===Z){this._makeMove({color:C,from:_,to:this._epSquare,piece:Z,captured:Z,flags:R.EP_CAPTURE});const E=!this._isKingAttacked(C);if(this._undoMove(),E){i=fe(this._epSquare);break}}}}return[r,this._turn,n,i,this._halfMoves,this._moveNumber].join(" ")}_updateSetup(e){this._history.length>0||(e!==At?(this._header.SetUp="1",this._header.FEN=e):(delete this._header.SetUp,delete this._header.FEN))}reset(){this.load(At)}get(e){return this._board[O[e]]||!1}put({type:e,color:r},n){if(ls.indexOf(e.toLowerCase())===-1||!(n in O))return!1;const i=O[n];return e==V&&!(this._kings[r]==ce||this._kings[r]==i)?!1:(this._board[i]={type:e,color:r},e===V&&(this._kings[r]=i),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0)}remove(e){const r=this.get(e);return delete this._board[O[e]],r&&r.type===V&&(this._kings[r.color]=ce),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),r}_updateCastlingRights(){var n,i,s,a,l,d,_,C,E,b,M,T;const e=((n=this._board[O.e1])==null?void 0:n.type)===V&&((i=this._board[O.e1])==null?void 0:i.color)===se,r=((s=this._board[O.e8])==null?void 0:s.type)===V&&((a=this._board[O.e8])==null?void 0:a.color)===pe;(!e||((l=this._board[O.a1])==null?void 0:l.type)!==Je||((d=this._board[O.a1])==null?void 0:d.color)!==se)&&(this._castling.w&=~R.QSIDE_CASTLE),(!e||((_=this._board[O.h1])==null?void 0:_.type)!==Je||((C=this._board[O.h1])==null?void 0:C.color)!==se)&&(this._castling.w&=~R.KSIDE_CASTLE),(!r||((E=this._board[O.a8])==null?void 0:E.type)!==Je||((b=this._board[O.a8])==null?void 0:b.color)!==pe)&&(this._castling.b&=~R.QSIDE_CASTLE),(!r||((M=this._board[O.h8])==null?void 0:M.type)!==Je||((T=this._board[O.h8])==null?void 0:T.color)!==pe)&&(this._castling.b&=~R.KSIDE_CASTLE)}_updateEnPassantSquare(){var s,a;if(this._epSquare===ce)return;const e=this._epSquare+(this._turn===se?-16:16),r=this._epSquare+(this._turn===se?16:-16),n=[r+1,r-1];if(this._board[e]!==null||this._board[this._epSquare]!==null||((s=this._board[r])==null?void 0:s.color)!==Xe(this._turn)||((a=this._board[r])==null?void 0:a.type)!==Z){this._epSquare=ce;return}const i=l=>{var d,_;return!(l&136)&&((d=this._board[l])==null?void 0:d.color)===this._turn&&((_=this._board[l])==null?void 0:_.type)===Z};n.some(i)||(this._epSquare=ce)}_attacked(e,r){for(let n=O.a8;n<=O.h1;n++){if(n&136){n+=7;continue}if(this._board[n]===void 0||this._board[n].color!==e)continue;const i=this._board[n],s=n-r;if(s===0)continue;const a=s+119;if(os[a]&us[i.type]){if(i.type===Z){if(s>0){if(i.color===se)return!0}else if(i.color===pe)return!0;continue}if(i.type==="n"||i.type==="k")return!0;const l=as[a];let d=n+l,_=!1;for(;d!==r;){if(this._board[d]!=null){_=!0;break}d+=l}if(!_)return!0}}return!1}_isKingAttacked(e){const r=this._kings[e];return r===-1?!1:this._attacked(Xe(e),r)}isAttacked(e,r){return this._attacked(r,O[e])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&this._moves().length===0}isStalemate(){return!this.isCheck()&&this._moves().length===0}isInsufficientMaterial(){const e={b:0,n:0,r:0,q:0,k:0,p:0},r=[];let n=0,i=0;for(let s=O.a8;s<=O.h1;s++){if(i=(i+1)%2,s&136){s+=7;continue}const a=this._board[s];a&&(e[a.type]=a.type in e?e[a.type]+1:1,a.type===lt&&r.push(i),n++)}if(n===2)return!0;if(n===3&&(e[lt]===1||e[Nt]===1))return!0;if(n===e[lt]+2){let s=0;const a=r.length;for(let l=0;l<a;l++)s+=r[l];if(s===0||s===a)return!0}return!1}isThreefoldRepetition(){const e=[],r={};let n=!1;for(;;){const i=this._undoMove();if(!i)break;e.push(i)}for(;;){const i=this.fen().split(" ").slice(0,4).join(" ");r[i]=i in r?r[i]+1:1,r[i]>=3&&(n=!0);const s=e.pop();if(s)this._makeMove(s);else break}return n}isDraw(){return this._halfMoves>=100||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isStalemate()||this.isDraw()}moves({verbose:e=!1,square:r=void 0,piece:n=void 0}={}){const i=this._moves({square:r,piece:n});return e?i.map(s=>this._makePretty(s)):i.map(s=>this._moveToSan(s,i))}_moves({legal:e=!0,piece:r=void 0,square:n=void 0}={}){var M;const i=n?n.toLowerCase():void 0,s=r==null?void 0:r.toLowerCase(),a=[],l=this._turn,d=Xe(l);let _=O.a8,C=O.h1,E=!1;if(i)if(i in O)_=C=O[i],E=!0;else return[];for(let T=_;T<=C;T++){if(T&136){T+=7;continue}if(!this._board[T]||this._board[T].color===d)continue;const{type:k}=this._board[T];let D;if(k===Z){if(s&&s!==k)continue;D=T+Rt[l][0],this._board[D]||(qe(a,l,T,D,Z),D=T+Rt[l][1],ds[l]===je(T)&&!this._board[D]&&qe(a,l,T,D,Z,void 0,R.BIG_PAWN));for(let B=2;B<4;B++)D=T+Rt[l][B],!(D&136)&&(((M=this._board[D])==null?void 0:M.color)===d?qe(a,l,T,D,Z,this._board[D].type,R.CAPTURE):D===this._epSquare&&qe(a,l,T,D,Z,Z,R.EP_CAPTURE))}else{if(s&&s!==k)continue;for(let B=0,ae=hr[k].length;B<ae;B++){const P=hr[k][B];for(D=T;D+=P,!(D&136);){if(!this._board[D])qe(a,l,T,D,k);else{if(this._board[D].color===l)break;qe(a,l,T,D,k,this._board[D].type,R.CAPTURE);break}if(k===Nt||k===V)break}}}}if((s===void 0||s===V)&&(!E||C===this._kings[l])){if(this._castling[l]&R.KSIDE_CASTLE){const T=this._kings[l],k=T+2;!this._board[T+1]&&!this._board[k]&&!this._attacked(d,this._kings[l])&&!this._attacked(d,T+1)&&!this._attacked(d,k)&&qe(a,l,this._kings[l],k,V,void 0,R.KSIDE_CASTLE)}if(this._castling[l]&R.QSIDE_CASTLE){const T=this._kings[l],k=T-2;!this._board[T-1]&&!this._board[T-2]&&!this._board[T-3]&&!this._attacked(d,this._kings[l])&&!this._attacked(d,T-1)&&!this._attacked(d,k)&&qe(a,l,this._kings[l],k,V,void 0,R.QSIDE_CASTLE)}}if(!e||this._kings[l]===-1)return a;const b=[];for(let T=0,k=a.length;T<k;T++)this._makeMove(a[T]),this._isKingAttacked(l)||b.push(a[T]),this._undoMove();return b}move(e,{strict:r=!1}={}){let n=null;if(typeof e=="string")n=this._moveFromSan(e,r);else if(typeof e=="object"){const s=this._moves();for(let a=0,l=s.length;a<l;a++)if(e.from===fe(s[a].from)&&e.to===fe(s[a].to)&&(!("promotion"in s[a])||e.promotion===s[a].promotion)){n=s[a];break}}if(!n)throw typeof e=="string"?new Error(`Invalid move: ${e}`):new Error(`Invalid move: ${JSON.stringify(e)}`);const i=this._makePretty(n);return this._makeMove(n),i}_push(e){this._history.push({move:e,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_makeMove(e){const r=this._turn,n=Xe(r);if(this._push(e),this._board[e.to]=this._board[e.from],delete this._board[e.from],e.flags&R.EP_CAPTURE&&(this._turn===pe?delete this._board[e.to-16]:delete this._board[e.to+16]),e.promotion&&(this._board[e.to]={type:e.promotion,color:r}),this._board[e.to].type===V){if(this._kings[r]=e.to,e.flags&R.KSIDE_CASTLE){const i=e.to-1,s=e.to+1;this._board[i]=this._board[s],delete this._board[s]}else if(e.flags&R.QSIDE_CASTLE){const i=e.to+1,s=e.to-2;this._board[i]=this._board[s],delete this._board[s]}this._castling[r]=0}if(this._castling[r]){for(let i=0,s=Ie[r].length;i<s;i++)if(e.from===Ie[r][i].square&&this._castling[r]&Ie[r][i].flag){this._castling[r]^=Ie[r][i].flag;break}}if(this._castling[n]){for(let i=0,s=Ie[n].length;i<s;i++)if(e.to===Ie[n][i].square&&this._castling[n]&Ie[n][i].flag){this._castling[n]^=Ie[n][i].flag;break}}e.flags&R.BIG_PAWN?r===pe?this._epSquare=e.to-16:this._epSquare=e.to+16:this._epSquare=ce,e.piece===Z?this._halfMoves=0:e.flags&(R.CAPTURE|R.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,r===pe&&this._moveNumber++,this._turn=n}undo(){const e=this._undoMove();return e?this._makePretty(e):null}_undoMove(){const e=this._history.pop();if(e===void 0)return null;const r=e.move;this._kings=e.kings,this._turn=e.turn,this._castling=e.castling,this._epSquare=e.epSquare,this._halfMoves=e.halfMoves,this._moveNumber=e.moveNumber;const n=this._turn,i=Xe(n);if(this._board[r.from]=this._board[r.to],this._board[r.from].type=r.piece,delete this._board[r.to],r.captured)if(r.flags&R.EP_CAPTURE){let s;n===pe?s=r.to-16:s=r.to+16,this._board[s]={type:Z,color:i}}else this._board[r.to]={type:r.captured,color:i};if(r.flags&(R.KSIDE_CASTLE|R.QSIDE_CASTLE)){let s,a;r.flags&R.KSIDE_CASTLE?(s=r.to+1,a=r.to-1):(s=r.to-2,a=r.to+1),this._board[s]=this._board[a],delete this._board[a]}return r}pgn({newline:e=`
`,maxWidth:r=0}={}){const n=[];let i=!1;for(const b in this._header)n.push("["+b+' "'+this._header[b]+'"]'+e),i=!0;i&&this._history.length&&n.push(e);const s=b=>{const M=this._comments[this.fen()];if(typeof M<"u"){const T=b.length>0?" ":"";b=`${b}${T}{${M}}`}return b},a=[];for(;this._history.length>0;)a.push(this._undoMove());const l=[];let d="";for(a.length===0&&l.push(s(""));a.length>0;){d=s(d);const b=a.pop();if(!b)break;if(!this._history.length&&b.color==="b"){const M=`${this._moveNumber}. ...`;d=d?`${d} ${M}`:M}else b.color==="w"&&(d.length&&l.push(d),d=this._moveNumber+".");d=d+" "+this._moveToSan(b,this._moves({legal:!0})),this._makeMove(b)}if(d.length&&l.push(s(d)),typeof this._header.Result<"u"&&l.push(this._header.Result),r===0)return n.join("")+l.join(" ");const _=function(){return n.length>0&&n[n.length-1]===" "?(n.pop(),!0):!1},C=function(b,M){for(const T of M.split(" "))if(T){if(b+T.length>r){for(;_();)b--;n.push(e),b=0}n.push(T),b+=T.length,n.push(" "),b++}return _()&&b--,b};let E=0;for(let b=0;b<l.length;b++){if(E+l[b].length>r&&l[b].includes("{")){E=C(E,l[b]);continue}E+l[b].length>r&&b!==0?(n[n.length-1]===" "&&n.pop(),n.push(e),E=0):b!==0&&(n.push(" "),E++),n.push(l[b]),E+=l[b].length}return n.join("")}header(...e){for(let r=0;r<e.length;r+=2)typeof e[r]=="string"&&typeof e[r+1]=="string"&&(this._header[e[r]]=e[r+1]);return this._header}loadPgn(e,{strict:r=!1,newlineChar:n=`\r?
`}={}){function i(P){return P.replace(/\\/g,"\\")}function s(P){const Y={},c=P.split(new RegExp(i(n)));let p="",g="";for(let v=0;v<c.length;v++){const I=/^\s*\[\s*([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;p=c[v].replace(I,"$1"),g=c[v].replace(I,"$2"),p.trim().length>0&&(Y[p]=g)}return Y}e=e.trim();const l=new RegExp("^(\\[((?:"+i(n)+")|.)*\\])((?:\\s*"+i(n)+"){2}|(?:\\s*"+i(n)+")*$)").exec(e),d=l&&l.length>=2?l[1]:"";this.reset();const _=s(d);let C="";for(const P in _)P.toLowerCase()==="fen"&&(C=_[P]),this.header(P,_[P]);if(!r)C&&this.load(C,!0);else if(_.SetUp==="1"){if(!("FEN"in _))throw new Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(_.FEN,!0)}function E(P){return Array.from(P).map(function(Y){return Y.charCodeAt(0)<128?Y.charCodeAt(0).toString(16):encodeURIComponent(Y).replace(/%/g,"").toLowerCase()}).join("")}function b(P){return P.length==0?"":decodeURIComponent("%"+(P.match(/.{1,2}/g)||[]).join("%"))}const M=function(P){return P=P.replace(new RegExp(i(n),"g")," "),`{${E(P.slice(1,P.length-1))}}`},T=function(P){if(P.startsWith("{")&&P.endsWith("}"))return b(P.slice(1,P.length-1))};let k=e.replace(d,"").replace(new RegExp(`({[^}]*})+?|;([^${i(n)}]*)`,"g"),function(P,Y,c){return Y!==void 0?M(Y):" "+M(`{${c.slice(1)}}`)}).replace(new RegExp(i(n),"g")," ");const D=/(\([^()]+\))+?/g;for(;D.test(k);)k=k.replace(D,"");k=k.replace(/\d+\.(\.\.)?/g,""),k=k.replace(/\.\.\./g,""),k=k.replace(/\$\d+/g,"");let B=k.trim().split(new RegExp(/\s+/));B=B.filter(P=>P!=="");let ae="";for(let P=0;P<B.length;P++){const Y=T(B[P]);if(Y!==void 0){this._comments[this.fen()]=Y;continue}const c=this._moveFromSan(B[P],r);if(c==null)if(_s.indexOf(B[P])>-1)ae=B[P];else throw new Error(`Invalid move in PGN: ${B[P]}`);else ae="",this._makeMove(c)}ae&&Object.keys(this._header).length&&!this._header.Result&&this.header("Result",ae)}_moveToSan(e,r){let n="";if(e.flags&R.KSIDE_CASTLE)n="O-O";else if(e.flags&R.QSIDE_CASTLE)n="O-O-O";else{if(e.piece!==Z){const i=ms(e,r);n+=e.piece.toUpperCase()+i}e.flags&(R.CAPTURE|R.EP_CAPTURE)&&(e.piece===Z&&(n+=fe(e.from)[0]),n+="x"),n+=fe(e.to),e.promotion&&(n+="="+e.promotion.toUpperCase())}return this._makeMove(e),this.isCheck()&&(this.isCheckmate()?n+="#":n+="+"),this._undoMove(),n}_moveFromSan(e,r=!1){const n=Ot(e);let i=dr(n),s=this._moves({legal:!0,piece:i});for(let b=0,M=s.length;b<M;b++)if(n===Ot(this._moveToSan(s[b],s)))return s[b];if(r)return null;let a,l,d,_,C,E=!1;if(l=n.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),l?(a=l[1],d=l[2],_=l[3],C=l[4],d.length==1&&(E=!0)):(l=n.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),l&&(a=l[1],d=l[2],_=l[3],C=l[4],d.length==1&&(E=!0))),i=dr(n),s=this._moves({legal:!0,piece:a||i}),!_)return null;for(let b=0,M=s.length;b<M;b++)if(d){if((!a||a.toLowerCase()==s[b].piece)&&O[d]==s[b].from&&O[_]==s[b].to&&(!C||C.toLowerCase()==s[b].promotion))return s[b];if(E){const T=fe(s[b].from);if((!a||a.toLowerCase()==s[b].piece)&&O[_]==s[b].to&&(d==T[0]||d==T[1])&&(!C||C.toLowerCase()==s[b].promotion))return s[b]}}else if(n===Ot(this._moveToSan(s[b],s)).replace("x",""))return s[b];return null}ascii(){let e=`   +------------------------+
`;for(let r=O.a8;r<=O.h1;r++){if(Ze(r)===0&&(e+=" "+"87654321"[je(r)]+" |"),this._board[r]){const n=this._board[r].type,s=this._board[r].color===se?n.toUpperCase():n.toLowerCase();e+=" "+s+" "}else e+=" . ";r+1&136&&(e+=`|
`,r+=8)}return e+=`   +------------------------+
`,e+="     a  b  c  d  e  f  g  h",e}perft(e){const r=this._moves({legal:!1});let n=0;const i=this._turn;for(let s=0,a=r.length;s<a;s++)this._makeMove(r[s]),this._isKingAttacked(i)||(e-1>0?n+=this.perft(e-1):n++),this._undoMove();return n}_makePretty(e){const{color:r,piece:n,from:i,to:s,flags:a,captured:l,promotion:d}=e;let _="";for(const M in R)R[M]&a&&(_+=ss[M]);const C=fe(i),E=fe(s),b={color:r,piece:n,from:C,to:E,san:this._moveToSan(e,this._moves({legal:!0})),flags:_,lan:C+E,before:this.fen(),after:""};return this._makeMove(e),b.after=this.fen(),this._undoMove(),l&&(b.captured=l),d&&(b.promotion=d,b.lan+=d),b}turn(){return this._turn}board(){const e=[];let r=[];for(let n=O.a8;n<=O.h1;n++)this._board[n]==null?r.push(null):r.push({square:fe(n),type:this._board[n].type,color:this._board[n].color}),n+1&136&&(e.push(r),r=[],n+=8);return e}squareColor(e){if(e in O){const r=O[e];return(je(r)+Ze(r))%2===0?"light":"dark"}return null}history({verbose:e=!1}={}){const r=[],n=[];for(;this._history.length>0;)r.push(this._undoMove());for(;;){const i=r.pop();if(!i)break;e?n.push(this._makePretty(i)):n.push(this._moveToSan(i,this._moves())),this._makeMove(i)}return n}_pruneComments(){const e=[],r={},n=i=>{i in this._comments&&(r[i]=this._comments[i])};for(;this._history.length>0;)e.push(this._undoMove());for(n(this.fen());;){const i=e.pop();if(!i)break;this._makeMove(i),n(this.fen())}this._comments=r}getComment(){return this._comments[this.fen()]}setComment(e){this._comments[this.fen()]=e.replace("{","[").replace("}","]")}deleteComment(){const e=this._comments[this.fen()];return delete this._comments[this.fen()],e}getComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>({fen:e,comment:this._comments[e]}))}deleteComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>{const r=this._comments[e];return delete this._comments[e],{fen:e,comment:r}})}setCastlingRights(e,r){for(const i of[V,xe])r[i]!==void 0&&(r[i]?this._castling[e]|=ot[i]:this._castling[e]&=~ot[i]);this._updateCastlingRights();const n=this.getCastlingRights(e);return(r[V]===void 0||r[V]===n[V])&&(r[xe]===void 0||r[xe]===n[xe])}getCastlingRights(e){return{[V]:(this._castling[e]&ot[V])!==0,[xe]:(this._castling[e]&ot[xe])!==0}}moveNumber(){return this._moveNumber}}export{Ts as C,Ps as H,Es as c,ws as s};
