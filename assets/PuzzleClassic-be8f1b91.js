import{g,C as k,B as M,_ as z,a as v,b as x}from"./skull-9b1a248b.js";import{C as c}from"./chess-19eddd7f.js";import{_ as N}from"./Chessboard-41cf930f.js";import{_ as A,h as f,b as r,c as a,g as t,i as m,w as C,v as P,t as n,z as B,F as d,p,A as q}from"./index-d4179996.js";import"./burgerMenu-ba336864.js";const H={mounted(){document.body.classList.add("hide-overflow")},unmounted(){document.body.classList.remove("hide-overflow")},data(){return{difficulty:1e3,fen:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",isWhite:!1,puzzle:{Themes:[]},correctMoves:[],moveNumber:0,square:"",wrongAttempts:0,history:[0],accuracy:{total:0,right:0,percent:100},streak:0,history2:[[-1,-1,-1,-1,-1]],boardAPI:null,offset:0}},async created(){await this.getNewPuzzle()},methods:{async getNewPuzzle(){this.puzzle=await g(this.difficulty,Math.floor(Math.random()*25)),console.log(this.puzzle),this.fen=""+this.puzzle.FEN,this.puzzle.Themes=this.puzzle.Themes.split(" "),this.correctMoves=this.puzzle.Moves.split(" "),this.isWhite=this.fen.split(" ")[1]=="b",await this.makeFirstMove()},async sleep(e){return new Promise(s=>setTimeout(s,e))},async makeFirstMove(){this.fen=""+this.puzzle.FEN,this.$refs.checkMark.deactivate(),await this.sleep(500);const e=new c(this.fen);e.move(this.correctMoves[0]),this.fen=e.fen(),this.moveNumber=1},async handleMove(e){console.log(e);const s=new c(this.fen);if(s.move(e),s.isCheckmate()||this.correctMoves[this.moveNumber]==e.from+e.to)if(this.square=e.to,this.moveNumber==this.correctMoves.length-1){this.accuracy.total++;var l=new Audio("/src/assets/success_sound.wav");l.play(),this.wrongAttempts==0&&(this.difficulty+=20+this.streak+Math.floor(Math.random()*10),this.accuracy.right++,this.streak++,this.difficulty-=this.offset),this.wrongAttempts==1&&(this.difficulty-=5+Math.floor(Math.random()*10),this.streak=0),this.wrongAttempts>1&&(this.difficulty-=15+Math.floor(Math.random()*10),this.streak=0),this.difficulty>3e3&&(this.difficulty=3e3),this.history.push(this.wrongAttempts),this.history2[this.history2.length-1][4]!=-1&&this.history2.push([-1,-1,-1,-1,-1]),this.history2[this.history2.length-1][this.history2[this.history2.length-1].indexOf(-1)]=this.wrongAttempts,this.accuracy.percent=Math.floor(this.accuracy.right/this.accuracy.total*100),this.wrongAttempts=0,await this.getNewPuzzle()}else{var l=new Audio("/src/assets/click_double.wav");l.play(),this.$refs.checkMark.activate();const i=new c(this.fen);i.move(e.from+e.to),i.move(this.correctMoves[this.moveNumber+1]),this.fen=i.fen(),this.moveNumber+=2}else{var l=new Audio("/src/assets/puzzle_fail.wav");l.play(),this.$refs.checkMark.deactivate(),this.wrongAttempts++,await this.makeFirstMove()}},async skip(){this.accuracy.total++,this.difficulty-=15+Math.floor(Math.random()*10),this.streak=0,this.history.push(5),this.history2[this.history2.length-1][4]!=-1&&this.history2.push([-1,-1,-1,-1,-1]),this.history2[this.history2.length-1][this.history2[this.history2.length-1].indexOf(-1)]=5,this.accuracy.percent=Math.floor(this.accuracy.right/this.accuracy.total*100),this.wrongAttempts=0,await this.getNewPuzzle()},makeHint(){console.log(this.correctMoves[this.moveNumber]),this.boardAPI.board.selectSquare(this.correctMoves[this.moveNumber][0]+this.correctMoves[this.moveNumber][1]),this.offset=10},async makeSolution(){this.$refs.checkMark.deactivate();const e=new c(this.fen);if(e.move(this.correctMoves[this.moveNumber]),this.moveNumber++,this.fen=e.fen(),this.wrongAttempts=2,e.isCheckmate()||this.moveNumber==this.correctMoves.length){this.accuracy.total++;var s=new Audio("/src/assets/success_sound.wav");s.play(),await this.sleep(1e3),this.wrongAttempts==0&&(this.difficulty+=20+this.streak+Math.floor(Math.random()*10),this.accuracy.right++,this.streak++),this.wrongAttempts==1&&(this.difficulty-=5+Math.floor(Math.random()*10),this.streak=0),this.wrongAttempts>1&&(this.difficulty-=15+Math.floor(Math.random()*10),this.streak=0),this.difficulty>3e3&&(this.difficulty=3e3),this.history.push(this.wrongAttempts),this.history2[this.history2.length-1][4]!=-1&&this.history2.push([-1,-1,-1,-1,-1]),this.history2[this.history2.length-1][this.history2[this.history2.length-1].indexOf(-1)]=this.wrongAttempts,this.accuracy.percent=Math.floor(this.accuracy.right/this.accuracy.total*100),this.wrongAttempts=0,await this.getNewPuzzle()}else{var s=new Audio("/src/assets/click_double.wav");s.play(),await this.sleep(1e3);const u=new c(this.fen);u.move(this.correctMoves[this.moveNumber]),this.moveNumber++,this.fen=u.fen()}}},watch:{difficulty(e){this.difficulty=Number(e)}},components:{Chessboard:N,Checkmark:k,BurgerMenuHorizontal:M}},S={class:"h-screen flex flex-col w-full sm:flex-row justify-center overflow-hidden"},F={class:"sm:basis-1/4 w-full flex flex-col sm:h-full p-2 sm:p-4 items-center"},T={class:"w-full flex flex-row"},j=t("span",{class:"material-symbols-outlined scale-150"}," home ",-1),V=[j],W={class:"text-xl mt-2"},E={class:"flex w-full justify-between p-4"},I={class:"relative w-1/2 scale-110"},L={class:"ml-36 relative w-1/2 scale-[3] flex items-center justify-center"},O=t("img",{src:z,class:"absolute z-10"},null,-1),R={class:"absolute z-20 text-black font-bold mt-5 text-xs"},D={class:"border-accent block border-4 rounded-xl m-4 w-full sm:h-1/2 h-16"},K={class:"flex-grow w-full h-full"},Q={class:"flex-content"},U={class:"scrollable-content-wrapper"},G={class:"flex flex-row justify-around my-4 sm:my-8"},J={key:0,class:"scale-150",src:v},X={key:1,class:"scale-150",src:x},Y={key:2,class:"scale-150 invisible",src:v},Z={class:"hidden sm:block w-full h-[8%] overflow-hidden"},$={class:"h-full w-full flex flex-wrap"},tt={class:"badge-secondary badge p-1 mx-1"},st={class:"w-full sm:w-1/2 relative flex h-full"},et={class:"basis-1/4 w-full py-4 flex justify-around"},it=t("span",{class:"material-symbols-outlined"}," lightbulb ",-1),ot=[it],rt=t("span",{class:"material-symbols-outlined"}," saved_search ",-1),at=[rt],ht=t("span",{class:"material-symbols-outlined"}," skip_next ",-1),lt=[ht];function ct(e,s,l,u,i,h){const w=f("BurgerMenuHorizontal"),_=f("Chessboard"),b=f("Checkmark");return r(),a("div",S,[t("div",F,[m(w,{class:"w-full h-0 sm:h-fit"}),t("div",T,[t("a",{to:"/",class:"tooltip tooltip-right rounded-lg block sm:hidden","data-tip":"Home",onClick:s[0]||(s[0]=o=>e.$router.push("/"))},V),C(t("input",{type:"range",min:"400",max:"3000","onUpdate:modelValue":s[1]||(s[1]=o=>i.difficulty=o),class:"range range-accent mt-4 sm:scale-100 scale-75"},null,512),[[P,i.difficulty]])]),t("p",W,n(i.difficulty),1),t("div",E,[t("div",I,[t("div",{class:"radial-progress bg-primary text-primary-content border-4 border-primary",style:B("--value:"+i.accuracy.percent)},n(i.accuracy.percent),5)]),t("div",L,[O,t("div",R,n(i.streak),1)])]),t("div",D,[t("div",K,[t("div",Q,[t("div",U,[(r(!0),a(d,null,p(i.history2,o=>(r(),a("div",G,[(r(!0),a(d,null,p(o,y=>(r(),a("div",null,[y==0?(r(),a("img",J)):q("",!0),y>0?(r(),a("img",X)):(r(),a("img",Y))]))),256))]))),256))])])])]),t("div",Z,[t("div",$,[(r(!0),a(d,null,p(i.puzzle.Themes,o=>(r(),a("div",null,[t("div",tt,n(o),1)]))),256))])])]),t("div",st,[m(_,{onBoardCreated:s[2]||(s[2]=o=>i.boardAPI=o),onMove:h.handleMove,fen:i.fen,orientation:i.isWhite?"white":"black",ref:"chessboard"},null,8,["onMove","fen","orientation"]),m(b,{square:i.square,ref:"checkMark",white:i.isWhite},null,8,["square","white"])]),t("div",et,[t("button",{onClick:s[3]||(s[3]=(...o)=>h.makeHint&&h.makeHint(...o)),class:"btn w-1/4 btn-primary mr-2 tooltip tooltip-bottom","data-tip":"Hint"},ot),t("button",{class:"btn w-1/4 btn-primary btn-square mr-2 tooltip tooltip-bottom","data-tip":"Solution",onClick:s[4]||(s[4]=(...o)=>h.makeSolution&&h.makeSolution(...o))},at),t("button",{class:"btn w-1/4 btn-primary btn-square mr-2 tooltip-bottom tooltip","data-tip":"Skip",onClick:s[5]||(s[5]=(...o)=>h.skip&&h.skip(...o))},lt)])])}const pt=A(H,[["render",ct]]);export{pt as default};
