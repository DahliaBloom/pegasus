import{g,C as z,B as M,a as p,_ as N,b as v,c as P}from"./skull-0f87a499.js";import{C as d}from"./chess-19eddd7f.js";import{_ as j}from"./Chessboard-a68380b7.js";import{_ as C,h as _,b as e,c as o,g as s,i as m,t as l,F as u,p as w,A as n}from"./index-be5fe4a5.js";import"./burgerMenu-ba336864.js";const a="/pegasus/assets/heart-e7db764f.svg",B={mounted(){document.body.classList.add("hide-overflow"),setInterval(()=>{console.log("Time: "+this.countdown),this.countdown>0&&this.mistakes<3&&this.countdown--},1e3)},unmounted(){document.body.classList.remove("hide-overflow")},data(){return{difficulty:1e3,fen:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",isWhite:!1,puzzle:{Themes:[]},correctMoves:[],moveNumber:0,square:"",wrongAttempts:0,history:[0],accuracy:{total:0,right:0,percent:100},streak:0,wins:0,history2:[[-1,-1,-1,-1,-1]],boardAPI:null,mistakes:0,bestStreak:0,countdown:3*60}},async created(){await this.getNewPuzzle()},methods:{async getNewPuzzle(){this.puzzle=await g(this.difficulty,Math.floor(Math.random()*25)),console.log(this.puzzle),this.fen=""+this.puzzle.FEN,this.puzzle.Themes=this.puzzle.Themes.split(" "),this.correctMoves=this.puzzle.Moves.split(" "),this.isWhite=this.fen.split(" ")[1]=="b",await this.makeFirstMove()},async sleep(i){return new Promise(c=>setTimeout(c,i))},async makeFirstMove(){this.fen=""+this.puzzle.FEN,this.$refs.checkMark.deactivate(),await this.sleep(500);const i=new d(this.fen);i.move(this.correctMoves[0]),this.fen=i.fen(),this.moveNumber=1},async handleMove(i){console.log(i);const c=new d(this.fen);if(c.move(i),c.isCheckmate()||this.correctMoves[this.moveNumber]==i.from+i.to)if(this.square=i.to,this.moveNumber==this.correctMoves.length-1){this.accuracy.total++;var h=new Audio("/src/assets/success_sound.wav");h.play(),this.difficulty+=20+Math.floor(Math.random()*10),this.wins++,this.streak++,this.difficulty>3e3&&(this.difficulty=3e3),this.history.push(0),this.history2[this.history2.length-1][4]!=-1&&this.history2.push([-1,-1,-1,-1,-1]),this.history2[this.history2.length-1][this.history2[this.history2.length-1].indexOf(-1)]=0,await this.getNewPuzzle()}else{var h=new Audio("/src/assets/click_double.wav");h.play(),this.$refs.checkMark.activate();const t=new d(this.fen);t.move(i.from+i.to),t.move(this.correctMoves[this.moveNumber+1]),this.fen=t.fen(),this.moveNumber+=2}else{var h=new Audio("/src/assets/puzzle_fail.wav");h.play(),this.$refs.checkMark.deactivate(),this.mistakes++,await this.skip()}},async skip(){this.accuracy.total++,this.difficulty-=15+Math.floor(Math.random()*10),this.streak>this.bestStreak&&(this.bestStreak=this.streak),this.streak=0,this.history.push(5),this.history2[this.history2.length-1][4]!=-1&&this.history2.push([-1,-1,-1,-1,-1]),this.history2[this.history2.length-1][this.history2[this.history2.length-1].indexOf(-1)]=5,this.accuracy.percent=Math.floor(this.accuracy.right/this.accuracy.total*100),this.wrongAttempts=0,await this.getNewPuzzle()},reload(){window.location.reload()}},watch:{difficulty(i){this.difficulty=Number(i)}},components:{Chessboard:j,Checkmark:z,BurgerMenuHorizontal:M}},A={class:"h-screen flex justify-center items-center z-0"},q={class:"basis-1/4 flex flex-col h-full p-4 items-center"},F={class:"flex w-full justify-between p-4"},T={class:"text-xl mt-2"},R={class:"ml-36 relative w-1/2 scale-[3] flex items-center justify-center"},S=s("img",{src:p,class:"absolute z-10"},null,-1),L={class:"absolute z-20 text-black font-bold mt-5 text-xs"},W={class:"border-accent border-4 rounded-xl m-4 mt-12 w-full h-1/2"},E={class:"flex-grow w-full h-full"},H={class:"flex-content"},I={class:"scrollable-content-wrapper"},V={class:"flex flex-row justify-around my-8"},K={key:0,class:"scale-150",src:v},O={key:1,class:"scale-150",src:P},Q={key:2,class:"scale-150 invisible",src:v},D={class:"w-full h-[8%] overflow-hidden"},G={class:"h-full w-full flex flex-wrap"},Y={class:"badge-secondary badge p-1 mx-1"},J={class:"w-1/2 relative flex h-full"},U={class:"basis-1/4 h-full w-full py-4 flex flex-col"},X={class:"flex flex-row justify-around w-full"},Z={key:0,class:"w-20 h-20 grayscale",src:a},$={key:1,class:"w-20 h-20 grayscale",src:a},ss={key:2,class:"w-20 h-20 grayscale",src:a},ts={key:3,class:"w-20 h-20",src:a},es={key:4,class:"w-20 h-20",src:a},os={key:5,class:"w-20 h-20",src:a},is={class:"w-full flex justify-around text-9xl text-accent"},ls={key:0,class:"absolute w-full h-full z-10 top-0 left-0 flex items-center justify-center"},cs=s("div",{class:"absolute w-full h-full bg-black z-20 top-0 left-0 flex items-center justify-center opacity-60"},null,-1),ns={class:"w-1/2 h-2/3 bg-base-100 z-30 rounded-2xl flex items-center justify-center"},rs={class:"w-[98%] h-[97%] border-2 border-primary z-40 rounded-2xl flex justify-start flex-col items-center"},hs=s("h1",{class:"text-6xl font-bold text-accent"},"You Lost",-1),as=s("br",null,null,-1),us=s("p",null,"get Good! By training more!",-1),fs=s("br",null,null,-1),ds={class:"w-full h-1/2 flex items-center justify-around flex-row"},_s={class:"h-full w-full m-4 relative"},ms=s("img",{src:p,class:"h-full w-full absolute z-10"},null,-1),ws={class:"h-full w-full absolute flex items-center justify-center"},ys={class:"absolute z-20 text-slate-900 text-6xl mt-20 font-bold"},ps={class:"h-full w-full text-8xl text-accent m-4 flex items-center justify-center"},vs={class:"h-full w-full m-4 relative"},bs=s("img",{src:N,class:"h-full w-full absolute z-10"},null,-1),ks={class:"h-full w-full absolute flex items-center justify-center"},xs={class:"absolute z-20 text-slate-900 text-6xl mb-20 font-bold"};function gs(i,c,h,zs,t,f){const b=_("BurgerMenuHorizontal"),k=_("Chessboard"),x=_("Checkmark");return e(),o(u,null,[s("div",A,[s("div",q,[m(b,{class:"w-full"}),s("div",F,[s("p",T,l(t.difficulty),1),s("div",R,[S,s("div",L,l(t.streak),1)])]),s("div",W,[s("div",E,[s("div",H,[s("div",I,[(e(!0),o(u,null,w(t.history2,r=>(e(),o("div",V,[(e(!0),o(u,null,w(r,y=>(e(),o("div",null,[y==0?(e(),o("img",K)):n("",!0),y>0?(e(),o("img",O)):(e(),o("img",Q))]))),256))]))),256))])])])]),s("div",D,[s("div",G,[(e(!0),o(u,null,w(t.puzzle.Themes,r=>(e(),o("div",null,[s("div",Y,l(r),1)]))),256))])])]),s("div",J,[m(k,{onBoardCreated:c[0]||(c[0]=r=>t.boardAPI=r),onMove:f.handleMove,fen:t.fen,orientation:t.isWhite?"white":"black",ref:"chessboard"},null,8,["onMove","fen","orientation"]),m(x,{square:t.square,ref:"checkMark",white:t.isWhite},null,8,["square","white"])]),s("div",U,[s("div",X,[t.mistakes>0?(e(),o("img",Z)):n("",!0),t.mistakes>1?(e(),o("img",$)):n("",!0),t.mistakes>2?(e(),o("img",ss)):n("",!0),t.mistakes<1?(e(),o("img",ts)):n("",!0),t.mistakes<2?(e(),o("img",es)):n("",!0),t.mistakes<3?(e(),o("img",os)):n("",!0)]),s("div",is,[s("p",null,l((t.countdown-t.countdown%60)/60)+":"+l((t.countdown%60-t.countdown%60%10)/10)+l(t.countdown%10),1)])])]),this.mistakes==3||this.countdown<=0?(e(),o("div",ls,[cs,s("div",ns,[s("div",rs,[hs,as,us,fs,s("div",ds,[s("div",_s,[ms,s("div",ws,[s("p",ys,l(t.bestStreak),1)])]),s("div",ps,l((t.countdown-t.countdown%60)/60)+":"+l((t.countdown%60-t.countdown%60%10)/10)+l(t.countdown%10),1),s("div",vs,[bs,s("div",ks,[s("p",xs,l(t.wins),1)])])]),s("button",{class:"btn-primary btn mt-8 w-1/6 h-12",onClick:c[1]||(c[1]=(...r)=>f.reload&&f.reload(...r))},"Retry")])])])):n("",!0)],64)}const Bs=C(B,[["render",gs]]);export{Bs as default};
