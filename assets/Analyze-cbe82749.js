import{_ as g,b as i,c as n,f as o,t as l,s as h,g as f,F as v,x as b,e as m,w as k,v as S}from"./index-9c61cb6a.js";const u={props:{evaluation:{type:Number,required:!0}},data(){return{height:50,heightString:"50%"}},methods:{update(){if(console.log("update"),this.evaluation===0){this.height=50,this.heightString=this.height+"%";return}let e=this.evaluation;e<0&&(e=-1*e),e<1?this.height=50+e*10:e<3?this.height=50+e*8:e<6?this.height=50+e*6:e<9?this.height=50+e*5:this.height=60,this.heightString=this.height+"%",console.log(this.heightString)}},beforeMount(){this.update()},updated(){this.update()}},d=()=>{b(e=>({"793adb2a":e.heightString}))},p=u.setup;u.setup=p?(e,t)=>(d(),p(e,t)):d;const P={class:"bg-black w-12 h-full text-white text-center m-4 static font-bold"},x={key:0},y={class:"bg-white w-12 text-center text-black m-4 absolute bottom-0 left-0 evalWhite"},$={key:0,class:"absolute bottom-0 left-1/4"};function B(e,t,s,a,q,R){return i(),n(v,null,[o("div",P,[this.evaluation<0?(i(),n("div",x,l(this.evaluation),1)):h("",!0),o("div",y,[this.evaluation>=0?(i(),n("span",$,l(this.evaluation),1)):h("",!0)])]),f(" "+l(this.heightString),1)],64)}const _=g(u,[["render",B],["__scopeId","data-v-9c1fb1c1"]]);let r,c=0;console.log("Starting stockfish");Stockfish().then(e=>{e.postMessage("setoption name use nnue value true"),e.addMessageListener(N),r=e,console.log("Stockfish started")});function N(e){if(e.startsWith("Final")){const s=/Final evaluation\s+([+-]?\d+\.\d+)/.exec(e);c=parseFloat(s[1]),console.log("Pegasus Final Score: "+c)}}async function w(e,t){if(r===void 0)return 0;r.postMessage(`position fen ${e}`),r.postMessage("eval"),setTimeout(()=>{t(c)},100)}const E={class:"flex",style:{height:"90vb"}},F={key:0},V=o("p",null,"r1b1k1nr/pppp1ppp/2n2q2/2b1p3/2B1P1Q1/2N5/PPPP1PPP/R1B1K1NR w KQkq - 6 5",-1),M=o("p",null,"Open console to see score!",-1),C={data(){return{fen:"",score:0,stockfish:null}},methods:{evaluatePosition(){w(this.fen,e=>{console.log("Received score:",e),this.score=e})}},components:{EvalBar:_}},j=Object.assign(C,{__name:"Analyze",setup(e){return(t,s)=>(i(),n("div",E,[m(_,{ref:"evalBar",class:"flex-none border-accent border-2",evaluation:t.score},null,8,["evaluation"]),o("div",null,[k(o("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>t.fen=a),type:"text",placeholder:"Enter FEN string"},null,512),[[S,t.fen]]),o("button",{onClick:s[1]||(s[1]=(...a)=>t.evaluatePosition&&t.evaluatePosition(...a))},"Evaluate"),t.score!==0?(i(),n("div",F,"Evaluation score: "+l(t.score),1)):h("",!0),V,M])]))}});export{j as default};
